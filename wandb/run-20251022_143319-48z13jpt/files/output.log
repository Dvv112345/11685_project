10/22/2025 14:33:20 - INFO - __main__ - ***** Training arguments *****
10/22/2025 14:33:20 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', data_dir='/ocean/projects/cis250019p/jye9/11685-project/data', is_cifar_10=True, image_size=32, batch_size=32, num_workers=4, num_classes=10, run_name='exp-7-ddpm', output_dir='/ocean/projects/cis250019p/jye9/11685-project/experiments', num_epochs=300, learning_rate=0.0005, weight_decay=0, grad_clip=1.0, seed=42, mixed_precision='none', use_val=True, num_train_timesteps=1000, num_inference_steps=100, beta_start=0.0001, beta_end=0.02, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, optimizer_type='AdamW', scheduler_type='ConsineAnnealingLR', unet_in_size=32, unet_in_ch=3, unet_ch=128, unet_ch_mult=[1, 2, 2, 2], unet_attn=[2], unet_num_res_blocks=2, unet_dropout=0.1, latent_ddpm=False, pretrained_vae='/ocean/projects/cis250019p/jye9/11685-project/pretrained/model.ckpt', use_cfg=False, cfg_guidance_scale=2.0, use_ddim=False, ckpt=None, device='cuda', rank=0, world_size=1, predictor_type='epsilon', distributed=False, local_rank=0, total_batch_size=32, max_train_steps=468600)
10/22/2025 14:33:20 - INFO - __main__ - ***** Running training *****
10/22/2025 14:33:20 - INFO - __main__ -   Num examples = 50000
10/22/2025 14:33:20 - INFO - __main__ -   Num Epochs = 300
10/22/2025 14:33:20 - INFO - __main__ -   Instantaneous batch size per device = 32
10/22/2025 14:33:20 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 32
10/22/2025 14:33:20 - INFO - __main__ -   Total optimization steps per epoch 1562
10/22/2025 14:33:20 - INFO - __main__ -   Total optimization steps = 468600
  0%|                                                                                                                                 | 0/468600 [00:00<?, ?it/s]10/22/2025 14:33:20 - INFO - __main__ - Epoch 1/300
  0%|▍                                                                                                                  | 1561/468600 [02:26<12:10:28, 10.66it/s]10/22/2025 14:35:47 - INFO - __main__ - Epoch 1/300, Step 1561/1562, Loss 0.05447610467672348 (0.06320543493538923)
10/22/2025 14:35:49 - INFO - __main__ - Epoch 1/300 Validation Loss: 0.035226
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 82.65it/s]
10/22/2025 14:35:51 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.1<00:00, 86.48it/s]
10/22/2025 14:35:51 - INFO - numexpr.utils - NumExpr defaulting to 16 threads.
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-7-ddpm/checkpoints/checkpoint_epoch_0.pth
10/22/2025 14:35:52 - INFO - __main__ - Epoch 2/300
  1%|▊                                                                                                                  | 3123/468600 [04:58<12:08:11, 10.65it/s]10/22/2025 14:38:18 - INFO - __main__ - Epoch 2/300, Step 1561/1562, Loss 0.021291393786668777 (0.037381989846218294)
10/22/2025 14:38:21 - INFO - __main__ - Epoch 2/300 Validation Loss: 0.032293
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 89.27it/s]
10/22/2025 14:38:22 - INFO - __main__ - Epoch 3/300█████████████████████████████████████████████████████████████████████████▎   | 97/100 [00:01<00:00, 88.91it/s]
  1%|█▏                                                                                                                 | 4685/468600 [07:29<12:07:42, 10.63it/s]10/22/2025 14:40:49 - INFO - __main__ - Epoch 3/300, Step 1561/1562, Loss 0.026106592267751694 (0.035087486284232854)
10/22/2025 14:40:51 - INFO - __main__ - Epoch 3/300 Validation Loss: 0.034983
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 89.52it/s]
10/22/2025 14:40:53 - INFO - __main__ - Epoch 4/300█████████████████████████████████████████████████████████████████████████▎   | 97/100 [00:01<00:00, 88.42it/s]
  1%|█▌                                                                                                                 | 6247/468600 [09:59<12:00:55, 10.69it/s]10/22/2025 14:43:19 - INFO - __main__ - Epoch 4/300, Step 1561/1562, Loss 0.02867462858557701 (0.03433887769853298)
10/22/2025 14:43:22 - INFO - __main__ - Epoch 4/300 Validation Loss: 0.030549
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 92.00it/s]
10/22/2025 14:43:23 - INFO - __main__ - Epoch 5/300████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 92.00it/s]
  2%|█▉                                                                                                                 | 7809/468600 [12:29<12:02:44, 10.63it/s]10/22/2025 14:45:49 - INFO - __main__ - Epoch 5/300, Step 1561/1562, Loss 0.04162267968058586 (0.03317874590550262)
10/22/2025 14:45:52 - INFO - __main__ - Epoch 5/300 Validation Loss: 0.034387
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 89.60it/s]
10/22/2025 14:45:53 - INFO - __main__ - Epoch 6/300███████████████████████████████████████████████████████████████████████████▊ | 99/100 [00:01<00:00, 87.61it/s]
  2%|██▎                                                                                                                | 9371/468600 [15:00<11:57:59, 10.66it/s]10/22/2025 14:48:20 - INFO - __main__ - Epoch 6/300, Step 1561/1562, Loss 0.04374631494283676 (0.03305722716372942)
10/22/2025 14:48:23 - INFO - __main__ - Epoch 6/300 Validation Loss: 0.031586
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 86.35it/s]
10/22/2025 14:48:24 - INFO - __main__ - Epoch 7/300███████████████████████████████████████████████████████████████████████████▊ | 99/100 [00:01<00:00, 87.49it/s]
  2%|██▋                                                                                                               | 10933/468600 [17:31<11:53:41, 10.69it/s]10/22/2025 14:50:51 - INFO - __main__ - Epoch 7/300, Step 1561/1562, Loss 0.04655027389526367 (0.03214729654992646)
10/22/2025 14:50:53 - INFO - __main__ - Epoch 7/300 Validation Loss: 0.034277
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 88.32it/s]
10/22/2025 14:50:55 - INFO - __main__ - Epoch 8/300████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 88.13it/s]
  3%|███                                                                                                               | 12495/468600 [20:01<11:52:58, 10.66it/s]10/22/2025 14:53:21 - INFO - __main__ - Epoch 8/300, Step 1561/1562, Loss 0.02585848979651928 (0.03243979265515081)
10/22/2025 14:53:24 - INFO - __main__ - Epoch 8/300 Validation Loss: 0.031921
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 89.26it/s]
10/22/2025 14:53:25 - INFO - __main__ - Epoch 9/300█████████████████████████████████████████████████████████████████████████▎   | 97/100 [00:01<00:00, 88.56it/s]
  3%|███▍                                                                                                              | 14057/468600 [22:31<11:49:58, 10.67it/s]10/22/2025 14:55:52 - INFO - __main__ - Epoch 9/300, Step 1561/1562, Loss 0.028271375223994255 (0.03208698075808461)
10/22/2025 14:55:54 - INFO - __main__ - Epoch 9/300 Validation Loss: 0.029752
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 91.58it/s]
10/22/2025 14:55:55 - INFO - __main__ - Epoch 10/300█████████████████████████████████████████████████████████████████████████▌  | 98/100 [00:01<00:00, 91.78it/s]
  3%|███▊                                                                                                              | 15619/468600 [25:01<11:49:49, 10.64it/s]10/22/2025 14:58:22 - INFO - __main__ - Epoch 10/300, Step 1561/1562, Loss 0.02891312539577484 (0.03175457625467421)
10/22/2025 14:58:24 - INFO - __main__ - Epoch 10/300 Validation Loss: 0.032437
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 86.54it/s]
10/22/2025 14:58:26 - INFO - __main__ - Epoch 11/300██████████████████████████████████████████████████████████████████████████▊ | 99/100 [00:01<00:00, 85.94it/s]
  4%|████▏                                                                                                             | 17182/468600 [27:32<11:46:09, 10.65it/s]10/22/2025 15:00:52 - INFO - __main__ - Epoch 11/300, Step 1561/1562, Loss 0.05271097272634506 (0.03190323446725857)
10/22/2025 15:00:55 - INFO - __main__ - Epoch 11/300 Validation Loss: 0.031797
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 85.31it/s]
10/22/2025 15:00:56 - INFO - __main__ - Epoch 12/300████████████████████████████████████████████████████████████████▉           | 91/100 [00:01<00:00, 87.78it/s]
  4%|████▌                                                                                                             | 18744/468600 [30:03<11:42:03, 10.68it/s]10/22/2025 15:03:23 - INFO - __main__ - Epoch 12/300, Step 1561/1562, Loss 0.029063811525702477 (0.0315640767175876)
10/22/2025 15:03:25 - INFO - __main__ - Epoch 12/300 Validation Loss: 0.028627
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 85.12it/s]
10/22/2025 15:03:27 - INFO - __main__ - Epoch 13/300██████████████████████████████████████████████████████████████████████████▊ | 99/100 [00:01<00:00, 86.16it/s]
  4%|████▉                                                                                                             | 20306/468600 [32:33<11:39:46, 10.68it/s]10/22/2025 15:05:53 - INFO - __main__ - Epoch 13/300, Step 1561/1562, Loss 0.03971210867166519 (0.030672974527960167)
10/22/2025 15:05:56 - INFO - __main__ - Epoch 13/300 Validation Loss: 0.032608
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 89.07it/s]
10/22/2025 15:05:57 - INFO - __main__ - Epoch 14/300███████████████████████████████████████████████████████████████████████     | 96/100 [00:01<00:00, 87.85it/s]
  5%|█████▎                                                                                                            | 21868/468600 [35:04<11:36:56, 10.68it/s]10/22/2025 15:08:24 - INFO - __main__ - Epoch 14/300, Step 1561/1562, Loss 0.03854380548000336 (0.03104294133855557)
10/22/2025 15:08:26 - INFO - __main__ - Epoch 14/300 Validation Loss: 0.030456
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 89.48it/s]
10/22/2025 15:08:28 - INFO - __main__ - Epoch 15/300████████████████████████████████████████████████████████████████████████▎   | 97/100 [00:01<00:00, 88.13it/s]
  5%|█████▋                                                                                                            | 23430/468600 [37:36<11:56:40, 10.35it/s]10/22/2025 15:10:56 - INFO - __main__ - Epoch 15/300, Step 1561/1562, Loss 0.018337935209274292 (0.03123992425836766)
10/22/2025 15:10:59 - INFO - __main__ - Epoch 15/300 Validation Loss: 0.031105
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 81.16it/s]
10/22/2025 15:11:01 - INFO - __main__ - Epoch 16/300██████████████████████████████████████████████████████████████████▏         | 92/100 [00:01<00:00, 86.86it/s]
  5%|██████                                                                                                            | 24992/468600 [40:07<11:34:58, 10.64it/s]10/22/2025 15:13:27 - INFO - __main__ - Epoch 16/300, Step 1561/1562, Loss 0.015055088326334953 (0.03132132329487942)
10/22/2025 15:13:30 - INFO - __main__ - Epoch 16/300 Validation Loss: 0.027336
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 89.17it/s]
10/22/2025 15:13:31 - INFO - __main__ - Epoch 17/300██████████████████████████████████████████████████████████████████▏         | 92/100 [00:01<00:00, 89.97it/s]
  6%|██████▍                                                                                                           | 26554/468600 [42:38<11:33:42, 10.62it/s]10/22/2025 15:15:58 - INFO - __main__ - Epoch 17/300, Step 1561/1562, Loss 0.029852908104658127 (0.030752101529713975)
10/22/2025 15:16:01 - INFO - __main__ - Epoch 17/300 Validation Loss: 0.033226
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 92.73it/s]
10/22/2025 15:16:02 - INFO - __main__ - Epoch 18/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 92.90it/s]
  6%|██████▊                                                                                                           | 28115/468600 [45:11<11:27:59, 10.67it/s]10/22/2025 15:18:31 - INFO - __main__ - Epoch 18/300, Step 1561/1562, Loss 0.03287851810455322 (0.030366080380539756)
10/22/2025 15:18:34 - INFO - __main__ - Epoch 18/300 Validation Loss: 0.031126
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 83.19it/s]
10/22/2025 15:18:35 - INFO - __main__ - Epoch 19/300████████████████████████████████████████████████████████████████████▌       | 94/100 [00:01<00:00, 86.77it/s]
  6%|███████▏                                                                                                          | 29677/468600 [47:42<11:25:27, 10.67it/s]10/22/2025 15:21:02 - INFO - __main__ - Epoch 19/300, Step 1561/1562, Loss 0.03786574676632881 (0.031192256481161345)
10/22/2025 15:21:05 - INFO - __main__ - Epoch 19/300 Validation Loss: 0.030791
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 86.45it/s]
10/22/2025 15:21:06 - INFO - __main__ - Epoch 20/300██████████████████████████████████████████████████████████████████████████▊ | 99/100 [00:01<00:00, 86.43it/s]
  7%|███████▌                                                                                                          | 31239/468600 [50:13<11:23:05, 10.67it/s]10/22/2025 15:23:33 - INFO - __main__ - Epoch 20/300, Step 1561/1562, Loss 0.030439574271440506 (0.03053846937620943)
10/22/2025 15:23:36 - INFO - __main__ - Epoch 20/300 Validation Loss: 0.029622
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 89.01it/s]
10/22/2025 15:23:37 - INFO - __main__ - Epoch 21/300███████████████████████████████████████████████████████████████████▍        | 93/100 [00:01<00:00, 90.32it/s]
  7%|███████▉                                                                                                          | 32801/468600 [52:44<11:24:04, 10.62it/s]10/22/2025 15:26:04 - INFO - __main__ - Epoch 21/300, Step 1561/1562, Loss 0.012101683765649796 (0.03042900690537008)
10/22/2025 15:26:07 - INFO - __main__ - Epoch 21/300 Validation Loss: 0.027335
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 91.75it/s]
10/22/2025 15:26:08 - INFO - __main__ - Epoch 22/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 92.20it/s]
  7%|████████▎                                                                                                         | 34363/468600 [55:14<11:21:40, 10.62it/s]10/22/2025 15:28:35 - INFO - __main__ - Epoch 22/300, Step 1561/1562, Loss 0.042420871555805206 (0.03033549367556308)
10/22/2025 15:28:37 - INFO - __main__ - Epoch 22/300 Validation Loss: 0.030831
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 90.98it/s]
10/22/2025 15:28:38 - INFO - __main__ - Epoch 23/300██████████████████████████████████████████████████████████████████████████▊ | 99/100 [00:01<00:00, 91.73it/s]
  7%|████████▍                                                                                                         | 34869/468600 [56:06<11:34:59, 10.40it/s]
