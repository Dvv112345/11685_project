10/20/2025 23:26:43 - INFO - __main__ - ***** Training arguments *****
10/20/2025 23:26:43 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', data_dir='/ocean/projects/cis250019p/jye9/11685-project/data', image_size=16, batch_size=64, num_workers=4, num_classes=10, run_name='exp-1-ddpm', output_dir='/ocean/projects/cis250019p/jye9/11685-project/experiments', num_epochs=5, learning_rate=0.01, weight_decay=0.01, grad_clip=1.0, seed=42, mixed_precision='none', num_train_timesteps=1000, num_inference_steps=1000, beta_start=0.0001, beta_end=0.02, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, optimizer_type='AdamW', scheduler_type='ConsineAnnealingLR', unet_in_size=128, unet_in_ch=3, unet_ch=128, unet_ch_mult=[1, 2, 2, 4], unet_attn=[2, 3], unet_num_res_blocks=2, unet_dropout=0.0, latent_ddpm=False, pretrained_vae='pretrained/model.ckpt', use_cfg=False, cfg_guidance_scale=2.0, use_ddim=False, ckpt=None, predictor_type='epsilon', distributed=False, world_size=1, rank=0, local_rank=0, device='cuda', total_batch_size=64, max_train_steps=3905)
10/20/2025 23:26:43 - INFO - __main__ - ***** Running training *****
10/20/2025 23:26:43 - INFO - __main__ -   Num examples = 50000
10/20/2025 23:26:43 - INFO - __main__ -   Num Epochs = 5
10/20/2025 23:26:43 - INFO - __main__ -   Instantaneous batch size per device = 64
10/20/2025 23:26:43 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 64
10/20/2025 23:26:43 - INFO - __main__ -   Total optimization steps per epoch 781
10/20/2025 23:26:43 - INFO - __main__ -   Total optimization steps = 3905
  0%|                                                                                      | 0/3905 [00:00<?, ?it/s]10/20/2025 23:26:43 - INFO - __main__ - Epoch 1/5
  0%|                                                                            | 1/3905 [00:05<6:22:44,  5.88s/it]10/20/2025 23:26:49 - INFO - __main__ - Epoch 1/5, Step 0/781, Loss 0.9912211298942566 (0.9912211298942566)
  3%|█▉                                                                          | 101/3905 [00:14<05:35, 11.36it/s]10/20/2025 23:26:58 - INFO - __main__ - Epoch 1/5, Step 100/781, Loss 0.9911100268363953 (1.0016596730392757)
  5%|███▉                                                                        | 201/3905 [00:23<05:24, 11.41it/s]10/20/2025 23:27:07 - INFO - __main__ - Epoch 1/5, Step 200/781, Loss 1.0036609172821045 (1.0006946268959425)
  8%|█████▊                                                                      | 301/3905 [00:32<05:16, 11.39it/s]10/20/2025 23:27:16 - INFO - __main__ - Epoch 1/5, Step 300/781, Loss 0.9996908903121948 (1.0004035539405292)
 10%|███████▊                                                                    | 401/3905 [00:41<05:08, 11.35it/s]10/20/2025 23:27:24 - INFO - __main__ - Epoch 1/5, Step 400/781, Loss 0.9924037456512451 (1.0003104085042291)
 13%|█████████▊                                                                  | 501/3905 [00:49<04:59, 11.38it/s]10/20/2025 23:27:33 - INFO - __main__ - Epoch 1/5, Step 500/781, Loss 1.0012892484664917 (1.0002222371672442)
 15%|███████████▋                                                                | 601/3905 [00:58<04:50, 11.37it/s]10/20/2025 23:27:42 - INFO - __main__ - Epoch 1/5, Step 600/781, Loss 1.0012691020965576 (1.000346717739264)
 18%|█████████████▋                                                              | 701/3905 [01:07<04:41, 11.36it/s]10/20/2025 23:27:51 - INFO - __main__ - Epoch 1/5, Step 700/781, Loss 0.9960858821868896 (1.0002691138657966)
100%|█████████████████████████████████████████████████████████████████████████████| 999/999 [00:53<00:00, 18.79it/s]
10/20/2025 23:28:57 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
10/20/2025 23:28:57 - INFO - numexpr.utils - NumExpr defaulting to 16 threads.
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-1-ddpm/checkpoints/checkpoint_epoch_0.pth
10/20/2025 23:29:03 - INFO - __main__ - Epoch 2/5
 20%|██████████████▌                                                          | 782/3905 [02:19<10:04:29, 11.61s/it]10/20/2025 23:29:03 - INFO - __main__ - Epoch 2/5, Step 0/781, Loss 1.0016162395477295 (1.0016162395477295)
 23%|█████████████████▏                                                          | 881/3905 [02:28<04:26, 11.35it/s]10/20/2025 23:29:12 - INFO - __main__ - Epoch 2/5, Step 100/781, Loss 1.0001596212387085 (0.9992215503560434)
 25%|███████████████████                                                         | 981/3905 [02:37<04:15, 11.44it/s]10/20/2025 23:29:21 - INFO - __main__ - Epoch 2/5, Step 200/781, Loss 0.997424304485321 (0.9993779745267991)
 28%|████████████████████▊                                                      | 1081/3905 [02:46<04:07, 11.40it/s]10/20/2025 23:29:30 - INFO - __main__ - Epoch 2/5, Step 300/781, Loss 1.0033901929855347 (0.9997888460903864)
 30%|██████████████████████▋                                                    | 1181/3905 [02:54<03:57, 11.47it/s]10/20/2025 23:29:38 - INFO - __main__ - Epoch 2/5, Step 400/781, Loss 0.9949294924736023 (0.9999566739634088)
 33%|████████████████████████▌                                                  | 1281/3905 [03:03<03:48, 11.46it/s]10/20/2025 23:29:47 - INFO - __main__ - Epoch 2/5, Step 500/781, Loss 1.0014324188232422 (0.9999118886308042)
 35%|██████████████████████████▌                                                | 1381/3905 [03:12<03:39, 11.48it/s]10/20/2025 23:29:56 - INFO - __main__ - Epoch 2/5, Step 600/781, Loss 1.0043059587478638 (1.0000187331150454)
 38%|████████████████████████████▍                                              | 1481/3905 [03:21<03:31, 11.44it/s]10/20/2025 23:30:05 - INFO - __main__ - Epoch 2/5, Step 700/781, Loss 0.9972063899040222 (1.00002760774909)
100%|█████████████████████████████████████████████████████████████████████████████| 999/999 [00:52<00:00, 18.95it/s]
10/20/2025 23:31:06 - INFO - __main__ - Epoch 3/5████████████████████████████████▉| 998/999 [00:52<00:00, 18.86it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-1-ddpm/checkpoints/checkpoint_epoch_1.pth
 40%|█████████████████████████████▏                                           | 1563/3905 [04:22<5:19:46,  8.19s/it]10/20/2025 23:31:06 - INFO - __main__ - Epoch 3/5, Step 0/781, Loss 1.0027786493301392 (1.0027786493301392)
 43%|███████████████████████████████▉                                           | 1662/3905 [04:31<03:16, 11.44it/s]10/20/2025 23:31:15 - INFO - __main__ - Epoch 3/5, Step 100/781, Loss 1.0062367916107178 (1.0001440437713471)
 45%|█████████████████████████████████▊                                         | 1762/3905 [04:39<03:08, 11.39it/s]10/20/2025 23:31:23 - INFO - __main__ - Epoch 3/5, Step 200/781, Loss 0.9999024271965027 (0.9999460411902091)
 48%|███████████████████████████████████▊                                       | 1862/3905 [04:48<02:59, 11.37it/s]10/20/2025 23:31:32 - INFO - __main__ - Epoch 3/5, Step 300/781, Loss 1.0031734704971313 (1.0001265893742888)
 50%|█████████████████████████████████████▋                                     | 1962/3905 [04:57<02:50, 11.40it/s]10/20/2025 23:31:41 - INFO - __main__ - Epoch 3/5, Step 400/781, Loss 1.0082329511642456 (1.0003028610103446)
 53%|███████████████████████████████████████▌                                   | 2062/3905 [05:06<02:40, 11.46it/s]10/20/2025 23:31:50 - INFO - __main__ - Epoch 3/5, Step 500/781, Loss 0.9984545111656189 (1.000450529143244)
 55%|█████████████████████████████████████████▌                                 | 2162/3905 [05:14<02:31, 11.47it/s]10/20/2025 23:31:58 - INFO - __main__ - Epoch 3/5, Step 600/781, Loss 0.9977960586547852 (1.0004260886132024)
 57%|██████████████████████████████████████████▋                                | 2222/3905 [05:20<02:26, 11.49it/s]
