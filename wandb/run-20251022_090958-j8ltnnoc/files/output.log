10/22/2025 09:09:59 - INFO - __main__ - ***** Training arguments *****
10/22/2025 09:09:59 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', data_dir='/ocean/projects/cis250019p/jye9/11685-project/data', image_size=32, batch_size=64, num_workers=4, num_classes=10, run_name='exp-4-ddpm', output_dir='/ocean/projects/cis250019p/jye9/11685-project/experiments', num_epochs=30, learning_rate=0.0001, weight_decay=0.01, grad_clip=1.0, seed=42, mixed_precision='none', num_train_timesteps=100, num_inference_steps=100, beta_start=0.0001, beta_end=0.02, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, optimizer_type='AdamW', scheduler_type='ConsineAnnealingLR', unet_in_size=32, unet_in_ch=3, unet_ch=64, unet_ch_mult=[1, 2, 2, 4], unet_attn=[2, 3], unet_num_res_blocks=1, unet_dropout=0.2, latent_ddpm=False, pretrained_vae='/ocean/projects/cis250019p/jye9/11685-project/pretrained/model.ckpt', use_cfg=False, cfg_guidance_scale=2.0, use_ddim=False, ckpt=None, device='cuda', rank=0, world_size=1, predictor_type='epsilon', distributed=False, local_rank=0, total_batch_size=64, max_train_steps=23430)
10/22/2025 09:09:59 - INFO - __main__ - ***** Running training *****
10/22/2025 09:09:59 - INFO - __main__ -   Num examples = 50000
10/22/2025 09:09:59 - INFO - __main__ -   Num Epochs = 30
10/22/2025 09:09:59 - INFO - __main__ -   Instantaneous batch size per device = 64
10/22/2025 09:09:59 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 64
10/22/2025 09:09:59 - INFO - __main__ -   Total optimization steps per epoch 781
10/22/2025 09:09:59 - INFO - __main__ -   Total optimization steps = 23430
  0%|                                                                                                                                  | 0/23430 [00:00<?, ?it/s]10/22/2025 09:09:59 - INFO - __main__ - Epoch 1/30
  0%|                                                                                                                        | 1/23430 [00:00<4:23:55,  1.48it/s]10/22/2025 09:10:00 - INFO - __main__ - Epoch 1/30, Step 0/781, Loss 0.9998959898948669 (0.9998959898948669)
  0%|▌                                                                                                                       | 101/23430 [00:06<22:05, 17.60it/s]10/22/2025 09:10:06 - INFO - __main__ - Epoch 1/30, Step 100/781, Loss 0.8533641695976257 (0.9342724002233826)
  1%|█                                                                                                                       | 201/23430 [00:12<21:57, 17.63it/s]10/22/2025 09:10:11 - INFO - __main__ - Epoch 1/30, Step 200/781, Loss 0.6413275003433228 (0.8391263686602388)
  1%|█▌                                                                                                                      | 301/23430 [00:17<21:58, 17.54it/s]10/22/2025 09:10:17 - INFO - __main__ - Epoch 1/30, Step 300/781, Loss 0.487873911857605 (0.7490868225842219)
  2%|██                                                                                                                      | 401/23430 [00:23<21:49, 17.58it/s]10/22/2025 09:10:23 - INFO - __main__ - Epoch 1/30, Step 400/781, Loss 0.3416646420955658 (0.6657619021479922)
  2%|██▌                                                                                                                     | 501/23430 [00:29<21:35, 17.70it/s]10/22/2025 09:10:28 - INFO - __main__ - Epoch 1/30, Step 500/781, Loss 0.2389465570449829 (0.5939813773194235)
  3%|███                                                                                                                     | 601/23430 [00:34<21:35, 17.62it/s]10/22/2025 09:10:34 - INFO - __main__ - Epoch 1/30, Step 600/781, Loss 0.20068058371543884 (0.5331776258156026)
  3%|███▌                                                                                                                    | 701/23430 [00:40<21:29, 17.63it/s]10/22/2025 09:10:40 - INFO - __main__ - Epoch 1/30, Step 700/781, Loss 0.14685839414596558 (0.4825406284755715)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 99/99 [00:00<00:00, 102.86it/s]
10/22/2025 09:10:45 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.<00:00, 111.02it/s]
10/22/2025 09:10:45 - INFO - numexpr.utils - NumExpr defaulting to 16 threads.
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_0.pth
10/22/2025 09:10:46 - INFO - __main__ - Epoch 2/30
10/22/2025 09:10:46 - INFO - __main__ - Epoch 2/30, Step 0/781, Loss 0.1433466076850891 (0.1433466076850891)
  4%|████▌                                                                                                                   | 881/23430 [00:52<21:22, 17.58it/s]10/22/2025 09:10:52 - INFO - __main__ - Epoch 2/30, Step 100/781, Loss 0.1416047215461731 (0.143410662170684)
  4%|█████                                                                                                                   | 981/23430 [00:58<21:13, 17.63it/s]10/22/2025 09:10:58 - INFO - __main__ - Epoch 2/30, Step 200/781, Loss 0.13882917165756226 (0.13852142208992546)
  5%|█████▍                                                                                                                 | 1081/23430 [01:03<21:07, 17.63it/s]10/22/2025 09:11:03 - INFO - __main__ - Epoch 2/30, Step 300/781, Loss 0.13023878633975983 (0.13573707325811005)
  5%|█████▉                                                                                                                 | 1181/23430 [01:09<20:55, 17.72it/s]10/22/2025 09:11:09 - INFO - __main__ - Epoch 2/30, Step 400/781, Loss 0.11665861308574677 (0.13352869640562004)
  5%|██████▌                                                                                                                | 1281/23430 [01:15<20:52, 17.68it/s]10/22/2025 09:11:15 - INFO - __main__ - Epoch 2/30, Step 500/781, Loss 0.10212719440460205 (0.13170065824500102)
  6%|███████                                                                                                                | 1381/23430 [01:20<20:39, 17.79it/s]10/22/2025 09:11:20 - INFO - __main__ - Epoch 2/30, Step 600/781, Loss 0.10935215651988983 (0.13004444641202142)
  6%|███████▌                                                                                                               | 1481/23430 [01:26<20:36, 17.76it/s]10/22/2025 09:11:26 - INFO - __main__ - Epoch 2/30, Step 700/781, Loss 0.1429668813943863 (0.12830148584152254)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 99/99 [00:00<00:00, 117.94it/s]
10/22/2025 09:11:31 - INFO - __main__ - Epoch 3/30██████████████████████████████████████████████████████████████████████████▎   | 96/99 [00:00<00:00, 118.28it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_1.pth
  7%|███████▊                                                                                                             | 1563/23430 [01:32<1:29:22,  4.08it/s]10/22/2025 09:11:32 - INFO - __main__ - Epoch 3/30, Step 0/781, Loss 0.10348081588745117 (0.10348081588745117)
  7%|████████▍                                                                                                              | 1663/23430 [01:37<20:25, 17.76it/s]10/22/2025 09:11:37 - INFO - __main__ - Epoch 3/30, Step 100/781, Loss 0.1225532814860344 (0.11629291955787356)
  8%|████████▉                                                                                                              | 1763/23430 [01:43<20:22, 17.73it/s]10/22/2025 09:11:43 - INFO - __main__ - Epoch 3/30, Step 200/781, Loss 0.11988510191440582 (0.11546834617556624)
  8%|█████████▍                                                                                                             | 1863/23430 [01:49<20:08, 17.85it/s]10/22/2025 09:11:48 - INFO - __main__ - Epoch 3/30, Step 300/781, Loss 0.11232514679431915 (0.11582928524658925)
  8%|█████████▉                                                                                                             | 1963/23430 [01:54<20:01, 17.87it/s]10/22/2025 09:11:54 - INFO - __main__ - Epoch 3/30, Step 400/781, Loss 0.12021942436695099 (0.11466161157945148)
  9%|██████████▍                                                                                                            | 2063/23430 [02:00<20:11, 17.63it/s]10/22/2025 09:12:00 - INFO - __main__ - Epoch 3/30, Step 500/781, Loss 0.12142853438854218 (0.11375368245228559)
  9%|██████████▉                                                                                                            | 2163/23430 [02:06<20:16, 17.48it/s]10/22/2025 09:12:05 - INFO - __main__ - Epoch 3/30, Step 600/781, Loss 0.09918725490570068 (0.11323568874508291)
 10%|███████████▍                                                                                                           | 2263/23430 [02:11<20:10, 17.49it/s]10/22/2025 09:12:11 - INFO - __main__ - Epoch 3/30, Step 700/781, Loss 0.09715275466442108 (0.11333342070841415)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 99/99 [00:00<00:00, 109.00it/s]
10/22/2025 09:12:17 - INFO - __main__ - Epoch 4/30██████████████████████████████████████████████████████████████████████████████| 99/99 [00:00<00:00, 109.18it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_2.pth
10/22/2025 09:12:17 - INFO - __main__ - Epoch 4/30, Step 0/781, Loss 0.1209435984492302 (0.1209435984492302)
 10%|████████████▍                                                                                                          | 2443/23430 [02:23<19:58, 17.51it/s]10/22/2025 09:12:23 - INFO - __main__ - Epoch 4/30, Step 100/781, Loss 0.10353662818670273 (0.1097158766766586)
 11%|████████████▉                                                                                                          | 2543/23430 [02:29<19:39, 17.71it/s]10/22/2025 09:12:29 - INFO - __main__ - Epoch 4/30, Step 200/781, Loss 0.12538594007492065 (0.1094437753457335)
 11%|█████████████▍                                                                                                         | 2643/23430 [02:34<19:45, 17.53it/s]10/22/2025 09:12:34 - INFO - __main__ - Epoch 4/30, Step 300/781, Loss 0.0941629633307457 (0.10943820112171364)
 12%|█████████████▉                                                                                                         | 2743/23430 [02:40<19:37, 17.58it/s]10/22/2025 09:12:40 - INFO - __main__ - Epoch 4/30, Step 400/781, Loss 0.10354866832494736 (0.10966760889996317)
 12%|██████████████▍                                                                                                        | 2843/23430 [02:46<19:30, 17.59it/s]10/22/2025 09:12:46 - INFO - __main__ - Epoch 4/30, Step 500/781, Loss 0.1096118614077568 (0.10933636191362392)
 13%|██████████████▉                                                                                                        | 2943/23430 [02:52<19:14, 17.75it/s]10/22/2025 09:12:51 - INFO - __main__ - Epoch 4/30, Step 600/781, Loss 0.09353836625814438 (0.10891047572583804)
 13%|███████████████▍                                                                                                       | 3043/23430 [02:57<19:20, 17.57it/s]10/22/2025 09:12:57 - INFO - __main__ - Epoch 4/30, Step 700/781, Loss 0.11247196793556213 (0.10904549909343733)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 99/99 [00:00<00:00, 114.72it/s]
10/22/2025 09:13:03 - INFO - __main__ - Epoch 5/30██████████████████████████████████████████████████████████████████████████▎   | 96/99 [00:00<00:00, 114.91it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_3.pth
 13%|███████████████▌                                                                                                     | 3125/23430 [03:03<1:34:45,  3.57it/s]10/22/2025 09:13:03 - INFO - __main__ - Epoch 5/30, Step 0/781, Loss 0.1019132062792778 (0.1019132062792778)
 14%|████████████████▍                                                                                                      | 3225/23430 [03:09<19:10, 17.56it/s]10/22/2025 09:13:09 - INFO - __main__ - Epoch 5/30, Step 100/781, Loss 0.11838695406913757 (0.10594716867302904)
 14%|████████████████▉                                                                                                      | 3325/23430 [03:15<19:02, 17.60it/s]10/22/2025 09:13:14 - INFO - __main__ - Epoch 5/30, Step 200/781, Loss 0.10184948146343231 (0.10552648573520765)
 15%|█████████████████▍                                                                                                     | 3425/23430 [03:20<18:56, 17.60it/s]10/22/2025 09:13:20 - INFO - __main__ - Epoch 5/30, Step 300/781, Loss 0.10534588992595673 (0.10595329365758009)
 15%|█████████████████▉                                                                                                     | 3525/23430 [03:26<18:54, 17.54it/s]10/22/2025 09:13:26 - INFO - __main__ - Epoch 5/30, Step 400/781, Loss 0.116172656416893 (0.10609518574954863)
 15%|██████████████████▍                                                                                                    | 3625/23430 [03:32<18:47, 17.57it/s]10/22/2025 09:13:32 - INFO - __main__ - Epoch 5/30, Step 500/781, Loss 0.08490531146526337 (0.10606379142242991)
 16%|██████████████████▉                                                                                                    | 3725/23430 [03:37<18:38, 17.62it/s]10/22/2025 09:13:37 - INFO - __main__ - Epoch 5/30, Step 600/781, Loss 0.11350911855697632 (0.10577726407525147)
 16%|███████████████████                                                                                                    | 3749/23430 [03:39<18:38, 17.59it/s]
