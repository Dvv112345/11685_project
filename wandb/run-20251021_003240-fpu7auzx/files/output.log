10/21/2025 00:32:41 - INFO - __main__ - ***** Training arguments *****
10/21/2025 00:32:41 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', data_dir='/ocean/projects/cis250019p/jye9/11685-project/data', image_size=32, batch_size=64, num_workers=4, num_classes=10, run_name='exp-3-ddpm', output_dir='/ocean/projects/cis250019p/jye9/11685-project/experiments', num_epochs=100, learning_rate=0.0001, weight_decay=0.01, grad_clip=1.0, seed=42, mixed_precision='none', num_train_timesteps=1000, num_inference_steps=1000, beta_start=0.0001, beta_end=0.008, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, optimizer_type='AdamW', scheduler_type='ConsineAnnealingLR', unet_in_size=32, unet_in_ch=3, unet_ch=64, unet_ch_mult=[1, 2, 2, 4], unet_attn=[2, 3], unet_num_res_blocks=1, unet_dropout=0.2, latent_ddpm=False, pretrained_vae='pretrained/model.ckpt', use_cfg=False, cfg_guidance_scale=2.0, use_ddim=False, ckpt=None, predictor_type='epsilon', distributed=False, world_size=1, rank=0, local_rank=0, device='cuda', total_batch_size=64, max_train_steps=78100)
10/21/2025 00:32:41 - INFO - __main__ - ***** Running training *****
10/21/2025 00:32:41 - INFO - __main__ -   Num examples = 50000
10/21/2025 00:32:41 - INFO - __main__ -   Num Epochs = 100
10/21/2025 00:32:41 - INFO - __main__ -   Instantaneous batch size per device = 64
10/21/2025 00:32:41 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 64
10/21/2025 00:32:41 - INFO - __main__ -   Total optimization steps per epoch 781
10/21/2025 00:32:41 - INFO - __main__ -   Total optimization steps = 78100
  0%|                                                                                     | 0/78100 [00:00<?, ?it/s]10/21/2025 00:32:41 - INFO - __main__ - Epoch 1/100
  0%|                                                                          | 1/78100 [00:00<14:52:35,  1.46it/s]10/21/2025 00:32:42 - INFO - __main__ - Epoch 1/100, Step 0/781, Loss 0.9998958110809326 (0.9998958110809326)
  0%|                                                                         | 101/78100 [00:06<1:13:28, 17.69it/s]10/21/2025 00:32:47 - INFO - __main__ - Epoch 1/100, Step 100/781, Loss 0.8406679034233093 (0.896099851273074)
  0%|▏                                                                        | 201/78100 [00:11<1:13:32, 17.66it/s]10/21/2025 00:32:53 - INFO - __main__ - Epoch 1/100, Step 200/781, Loss 0.646937906742096 (0.8371241380326191)
  0%|▎                                                                        | 301/78100 [00:17<1:13:15, 17.70it/s]10/21/2025 00:32:59 - INFO - __main__ - Epoch 1/100, Step 300/781, Loss 0.46108338236808777 (0.7288207504836428)
  1%|▎                                                                        | 401/78100 [00:23<1:12:38, 17.83it/s]10/21/2025 00:33:04 - INFO - __main__ - Epoch 1/100, Step 400/781, Loss 0.3258360028266907 (0.6515718665057584)
  1%|▍                                                                        | 501/78100 [00:28<1:11:54, 17.99it/s]10/21/2025 00:33:10 - INFO - __main__ - Epoch 1/100, Step 500/781, Loss 0.21946832537651062 (0.572214661214404)
  1%|▌                                                                        | 601/78100 [00:34<1:12:29, 17.82it/s]10/21/2025 00:33:16 - INFO - __main__ - Epoch 1/100, Step 600/781, Loss 0.1650935411453247 (0.5104496194895809)
  1%|▋                                                                        | 701/78100 [00:40<1:11:54, 17.94it/s]10/21/2025 00:33:21 - INFO - __main__ - Epoch 1/100, Step 700/781, Loss 0.099992536008358 (0.4549350080621056)
100%|████████████████████████████████████████████████████████████████████████████| 999/999 [00:08<00:00, 117.52it/s]
10/21/2025 00:33:34 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
10/21/2025 00:33:34 - INFO - numexpr.utils - NumExpr defaulting to 16 threads.
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-3-ddpm/checkpoints/checkpoint_epoch_0.pth
10/21/2025 00:33:35 - INFO - __main__ - Epoch 2/100
10/21/2025 00:33:35 - INFO - __main__ - Epoch 2/100, Step 0/781, Loss 0.08604028075933456 (0.08604028075933456)
  1%|▊                                                                        | 881/78100 [00:59<1:12:25, 17.77it/s]10/21/2025 00:33:41 - INFO - __main__ - Epoch 2/100, Step 100/781, Loss 0.07576364278793335 (0.08869348005345552)
  1%|▉                                                                        | 981/78100 [01:05<1:12:04, 17.83it/s]10/21/2025 00:33:47 - INFO - __main__ - Epoch 2/100, Step 200/781, Loss 0.08786168694496155 (0.08412862344834934)
  1%|▉                                                                       | 1081/78100 [01:11<1:11:57, 17.84it/s]10/21/2025 00:33:52 - INFO - __main__ - Epoch 2/100, Step 300/781, Loss 0.0539257749915123 (0.08017257206216206)
  2%|█                                                                       | 1181/78100 [01:16<1:12:24, 17.70it/s]10/21/2025 00:33:58 - INFO - __main__ - Epoch 2/100, Step 400/781, Loss 0.09385238587856293 (0.07734388140891853)
  2%|█▏                                                                      | 1281/78100 [01:22<1:12:17, 17.71it/s]10/21/2025 00:34:04 - INFO - __main__ - Epoch 2/100, Step 500/781, Loss 0.08416058868169785 (0.07537043728157432)
  2%|█▎                                                                      | 1381/78100 [01:27<1:11:45, 17.82it/s]10/21/2025 00:34:09 - INFO - __main__ - Epoch 2/100, Step 600/781, Loss 0.06401226669549942 (0.07375605893437558)
  2%|█▎                                                                      | 1481/78100 [01:33<1:11:38, 17.83it/s]10/21/2025 00:34:15 - INFO - __main__ - Epoch 2/100, Step 700/781, Loss 0.08820128440856934 (0.07241920360527433)
100%|████████████████████████████████████████████████████████████████████████████| 999/999 [00:08<00:00, 118.30it/s]
10/21/2025 00:34:28 - INFO - __main__ - Epoch 3/100█████████████████████████████▋| 995/999 [00:08<00:00, 118.60it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-3-ddpm/checkpoints/checkpoint_epoch_1.pth
  2%|█▍                                                                     | 1563/78100 [01:47<29:37:57,  1.39s/it]10/21/2025 00:34:28 - INFO - __main__ - Epoch 3/100, Step 0/781, Loss 0.08440487086772919 (0.08440487086772919)
  2%|█▌                                                                      | 1663/78100 [01:52<1:11:32, 17.81it/s]10/21/2025 00:34:34 - INFO - __main__ - Epoch 3/100, Step 100/781, Loss 0.04562877118587494 (0.06617812318081903)
  2%|█▋                                                                      | 1763/78100 [01:58<1:11:01, 17.91it/s]10/21/2025 00:34:40 - INFO - __main__ - Epoch 3/100, Step 200/781, Loss 0.06621633470058441 (0.06412958824515935)
  2%|█▋                                                                      | 1863/78100 [02:03<1:10:54, 17.92it/s]10/21/2025 00:34:45 - INFO - __main__ - Epoch 3/100, Step 300/781, Loss 0.053779713809490204 (0.06387257994310404)
  3%|█▊                                                                      | 1963/78100 [02:09<1:11:14, 17.81it/s]10/21/2025 00:34:51 - INFO - __main__ - Epoch 3/100, Step 400/781, Loss 0.07031518220901489 (0.06320453988866616)
  3%|█▉                                                                      | 2063/78100 [02:15<1:11:10, 17.81it/s]10/21/2025 00:34:56 - INFO - __main__ - Epoch 3/100, Step 500/781, Loss 0.06005887687206268 (0.06273767592277593)
  3%|█▉                                                                      | 2163/78100 [02:20<1:10:39, 17.91it/s]10/21/2025 00:35:02 - INFO - __main__ - Epoch 3/100, Step 600/781, Loss 0.06274350732564926 (0.06221210901406958)
  3%|██                                                                      | 2263/78100 [02:26<1:11:54, 17.58it/s]10/21/2025 00:35:08 - INFO - __main__ - Epoch 3/100, Step 700/781, Loss 0.06408794224262238 (0.06212564261786948)
100%|████████████████████████████████████████████████████████████████████████████| 999/999 [00:08<00:00, 116.84it/s]
10/21/2025 00:35:21 - INFO - __main__ - Epoch 4/100█████████████████████████████▊| 997/999 [00:08<00:00, 115.34it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-3-ddpm/checkpoints/checkpoint_epoch_2.pth
10/21/2025 00:35:21 - INFO - __main__ - Epoch 4/100, Step 0/781, Loss 0.04515930637717247 (0.04515930637717247)
  3%|██▎                                                                     | 2443/78100 [02:45<1:10:44, 17.83it/s]10/21/2025 00:35:27 - INFO - __main__ - Epoch 4/100, Step 100/781, Loss 0.06607507169246674 (0.05880933878297853)
  3%|██▎                                                                     | 2543/78100 [02:51<1:10:44, 17.80it/s]10/21/2025 00:35:32 - INFO - __main__ - Epoch 4/100, Step 200/781, Loss 0.06598852574825287 (0.05902543046803617)
  3%|██▍                                                                     | 2643/78100 [02:56<1:10:53, 17.74it/s]10/21/2025 00:35:38 - INFO - __main__ - Epoch 4/100, Step 300/781, Loss 0.04919153451919556 (0.0590759321700695)
  4%|██▌                                                                     | 2743/78100 [03:02<1:10:43, 17.76it/s]10/21/2025 00:35:44 - INFO - __main__ - Epoch 4/100, Step 400/781, Loss 0.051973119378089905 (0.05865268621993184)
  4%|██▌                                                                     | 2843/78100 [03:08<1:10:37, 17.76it/s]10/21/2025 00:35:49 - INFO - __main__ - Epoch 4/100, Step 500/781, Loss 0.06149368733167648 (0.05909303055998094)
  4%|██▋                                                                     | 2943/78100 [03:13<1:10:30, 17.77it/s]10/21/2025 00:35:55 - INFO - __main__ - Epoch 4/100, Step 600/781, Loss 0.05643928796052933 (0.059089581694410566)
  4%|██▊                                                                     | 3044/78100 [03:19<1:09:59, 17.87it/s]10/21/2025 00:36:01 - INFO - __main__ - Epoch 4/100, Step 700/781, Loss 0.07449807226657867 (0.05868338223828399)
100%|████████████████████████████████████████████████████████████████████████████| 999/999 [00:08<00:00, 118.75it/s]
10/21/2025 00:36:14 - INFO - __main__ - Epoch 5/100█████████████████████████████▍| 992/999 [00:08<00:00, 117.12it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-3-ddpm/checkpoints/checkpoint_epoch_3.pth
10/21/2025 00:36:14 - INFO - __main__ - Epoch 5/100, Step 0/781, Loss 0.04245985299348831 (0.04245985299348831)
  4%|██▉                                                                     | 3224/78100 [03:38<1:10:03, 17.81it/s]10/21/2025 00:36:20 - INFO - __main__ - Epoch 5/100, Step 100/781, Loss 0.046843014657497406 (0.05776464319465184)
  4%|███                                                                     | 3324/78100 [03:43<1:09:56, 17.82it/s]10/21/2025 00:36:25 - INFO - __main__ - Epoch 5/100, Step 200/781, Loss 0.06385102868080139 (0.05718699457188744)
  4%|███▏                                                                    | 3424/78100 [03:49<1:09:45, 17.84it/s]10/21/2025 00:36:31 - INFO - __main__ - Epoch 5/100, Step 300/781, Loss 0.06120271608233452 (0.05735656960660041)
  5%|███▏                                                                    | 3524/78100 [03:55<1:09:30, 17.88it/s]10/21/2025 00:36:36 - INFO - __main__ - Epoch 5/100, Step 400/781, Loss 0.0575454905629158 (0.05705970889909606)
  5%|███▎                                                                    | 3624/78100 [04:00<1:09:48, 17.78it/s]10/21/2025 00:36:42 - INFO - __main__ - Epoch 5/100, Step 500/781, Loss 0.06128166615962982 (0.05707307955521548)
  5%|███▍                                                                    | 3724/78100 [04:06<1:09:33, 17.82it/s]10/21/2025 00:36:48 - INFO - __main__ - Epoch 5/100, Step 600/781, Loss 0.07307563722133636 (0.057261709762293965)
  5%|███▌                                                                    | 3824/78100 [04:12<1:09:39, 17.77it/s]10/21/2025 00:36:53 - INFO - __main__ - Epoch 5/100, Step 700/781, Loss 0.06381431967020035 (0.05698344288938566)
100%|████████████████████████████████████████████████████████████████████████████| 999/999 [00:08<00:00, 115.88it/s]
10/21/2025 00:37:07 - INFO - __main__ - Epoch 6/100█████████████████████████████▊| 996/999 [00:08<00:00, 116.25it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-3-ddpm/checkpoints/checkpoint_epoch_4.pth
  5%|███▌                                                                   | 3906/78100 [04:25<29:13:58,  1.42s/it]10/21/2025 00:37:07 - INFO - __main__ - Epoch 6/100, Step 0/781, Loss 0.056761763989925385 (0.056761763989925385)
  5%|███▋                                                                    | 4006/78100 [04:31<1:08:52, 17.93it/s]10/21/2025 00:37:13 - INFO - __main__ - Epoch 6/100, Step 100/781, Loss 0.06736019253730774 (0.055411043254160644)
  5%|███▊                                                                    | 4106/78100 [04:37<1:09:43, 17.69it/s]10/21/2025 00:37:18 - INFO - __main__ - Epoch 6/100, Step 200/781, Loss 0.0732819065451622 (0.05595063755464791)
  5%|███▉                                                                    | 4206/78100 [04:42<1:08:42, 17.93it/s]10/21/2025 00:37:24 - INFO - __main__ - Epoch 6/100, Step 300/781, Loss 0.05299648642539978 (0.056579278020862725)
  5%|███▉                                                                    | 4246/78100 [04:44<1:08:51, 17.88it/s]
