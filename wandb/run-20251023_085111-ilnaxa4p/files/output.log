10/23/2025 08:51:24 - INFO - __main__ - ***** Training arguments *****
10/23/2025 08:51:24 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', data_dir='/ocean/projects/cis250019p/jye9/11685-project/data', is_cifar_10=True, image_size=32, batch_size=64, num_workers=4, num_classes=10, run_name='exp-0-ddpm', output_dir='/ocean/projects/cis250019p/jye9/11685-project/experiments', num_epochs=300, learning_rate=0.0001, weight_decay=0.02, grad_clip=1.0, seed=42, mixed_precision='none', use_val=True, num_train_timesteps=500, num_inference_steps=500, beta_start=0.0001, beta_end=0.01, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, optimizer_type='AdamW', scheduler_type='ConsineAnnealingLR', unet_in_size=32, unet_in_ch=3, unet_ch=64, unet_ch_mult=[1, 2, 2, 4], unet_attn=[2, 3], unet_num_res_blocks=2, unet_dropout=0.2, latent_ddpm=False, pretrained_vae='/ocean/projects/cis250019p/jye9/11685-project/pretrained/model.ckpt', use_cfg=False, cfg_guidance_scale=2, use_ddim=False, ckpt=None, device='cuda', rank=0, world_size=1, predictor_type='epsilon', distributed=False, local_rank=0, total_batch_size=64, max_train_steps=234300)
10/23/2025 08:51:24 - INFO - __main__ - ***** Running training *****
10/23/2025 08:51:24 - INFO - __main__ -   Num examples = 50000
10/23/2025 08:51:24 - INFO - __main__ -   Num Epochs = 300
10/23/2025 08:51:24 - INFO - __main__ -   Instantaneous batch size per device = 64
10/23/2025 08:51:24 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 64
10/23/2025 08:51:24 - INFO - __main__ -   Total optimization steps per epoch 781
10/23/2025 08:51:24 - INFO - __main__ -   Total optimization steps = 234300
  0%|                                                                                                                                 | 0/234300 [00:00<?, ?it/s]10/23/2025 08:51:24 - INFO - __main__ - Epoch 1/300
  0%|▍                                                                                                                    | 781/234300 [01:20<5:25:51, 11.94it/s]10/23/2025 08:52:44 - INFO - __main__ - Epoch 1/300, Step 780/781, Loss 0.0518675222992897 (0.25420899022365806)
10/23/2025 08:52:47 - INFO - __main__ - Epoch 1/300 Validation Loss: 0.073572
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 65.67it/s]
  0%|▍                                                                                                                    | 781/234300 [01:40<5:25:51, 11.94it/s]10/23/2025 08:53:05 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
10/23/2025 08:53:05 - INFO - numexpr.utils - NumExpr defaulting to 16 threads.
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-0-ddpm/checkpoints/checkpoint_epoch_0.pth
10/23/2025 08:53:13 - INFO - __main__ - Epoch 2/300
  1%|▊                                                                                                                   | 1562/234300 [02:54<5:35:46, 11.55it/s]10/23/2025 08:54:19 - INFO - __main__ - Epoch 2/300, Step 780/781, Loss 0.0711870938539505 (0.07365561869095597)
10/23/2025 08:54:21 - INFO - __main__ - Epoch 2/300 Validation Loss: 0.068720
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 78.81it/s]
10/23/2025 08:54:27 - INFO - __main__ - Epoch 3/300███████████████████████████████████████████████████████████████████████████▊| 498/499 [00:06<00:00, 79.92it/s]
  1%|█▏                                                                                                                  | 2342/234300 [04:09<6:23:12, 10.09it/s]10/23/2025 08:55:34 - INFO - __main__ - Epoch 3/300, Step 780/781, Loss 0.06734054535627365 (0.0696907132606424)
10/23/2025 08:55:36 - INFO - __main__ - Epoch 3/300 Validation Loss: 0.064450
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 76.15it/s]
10/23/2025 08:55:43 - INFO - __main__ - Epoch 4/300███████████████████████████████████████████████████████████████████████████▎| 496/499 [00:06<00:00, 76.54it/s]
  1%|█▌                                                                                                                  | 3124/234300 [05:24<5:23:59, 11.89it/s]10/23/2025 08:56:49 - INFO - __main__ - Epoch 4/300, Step 780/781, Loss 0.06775879859924316 (0.06694317214601171)
10/23/2025 08:56:52 - INFO - __main__ - Epoch 4/300 Validation Loss: 0.063967
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 75.62it/s]
10/23/2025 08:56:58 - INFO - __main__ - Epoch 5/300███████████████████████████████████████████████████████████████████████████▎| 496/499 [00:06<00:00, 75.73it/s]
  2%|█▉                                                                                                                  | 3904/234300 [06:40<5:16:50, 12.12it/s]10/23/2025 08:58:05 - INFO - __main__ - Epoch 5/300, Step 780/781, Loss 0.05835769698023796 (0.06600855843243923)
10/23/2025 08:58:07 - INFO - __main__ - Epoch 5/300 Validation Loss: 0.062438
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 63.65it/s]
10/23/2025 08:58:15 - INFO - __main__ - Epoch 6/300███████████████████████████████████████████████████████████████████████████ | 495/499 [00:07<00:00, 79.11it/s]
  2%|██▎                                                                                                                 | 4686/234300 [07:57<5:34:17, 11.45it/s]10/23/2025 08:59:22 - INFO - __main__ - Epoch 6/300, Step 780/781, Loss 0.0428941510617733 (0.0647072442324305)
10/23/2025 08:59:24 - INFO - __main__ - Epoch 6/300 Validation Loss: 0.063116
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 76.91it/s]
10/23/2025 08:59:31 - INFO - __main__ - Epoch 7/300███████████████████████████████████████████████████████████████████████████▎| 496/499 [00:06<00:00, 76.98it/s]
  2%|██▋                                                                                                                 | 5466/234300 [09:13<5:20:14, 11.91it/s]10/23/2025 09:00:38 - INFO - __main__ - Epoch 7/300, Step 780/781, Loss 0.07714787125587463 (0.064074300482354)
10/23/2025 09:00:40 - INFO - __main__ - Epoch 7/300 Validation Loss: 0.058639
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 75.34it/s]
10/23/2025 09:00:47 - INFO - __main__ - Epoch 8/300███████████████████████████████████████████████████████████████████████████▎| 496/499 [00:06<00:00, 76.02it/s]
  3%|███                                                                                                                 | 6248/234300 [10:29<5:23:07, 11.76it/s]10/23/2025 09:01:53 - INFO - __main__ - Epoch 8/300, Step 780/781, Loss 0.06636049598455429 (0.06376238319445664)
10/23/2025 09:01:56 - INFO - __main__ - Epoch 8/300 Validation Loss: 0.063010
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 76.55it/s]
10/23/2025 09:02:02 - INFO - __main__ - Epoch 9/300███████████████████████████████████████████████████████████████████████████▎| 496/499 [00:06<00:00, 75.72it/s]
  3%|███▍                                                                                                                | 7028/234300 [11:43<5:12:50, 12.11it/s]10/23/2025 09:03:08 - INFO - __main__ - Epoch 9/300, Step 780/781, Loss 0.07239110767841339 (0.06329151077932951)
10/23/2025 09:03:10 - INFO - __main__ - Epoch 9/300 Validation Loss: 0.061235
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:08<00:00, 59.38it/s]
10/23/2025 09:03:19 - INFO - __main__ - Epoch 10/300██████████████████████████████████████████████████████████████████████████▎| 496/499 [00:08<00:00, 58.81it/s]
  3%|███▊                                                                                                                | 7810/234300 [13:00<5:17:35, 11.89it/s]10/23/2025 09:04:25 - INFO - __main__ - Epoch 10/300, Step 780/781, Loss 0.060645781457424164 (0.06310710812252249)
10/23/2025 09:04:27 - INFO - __main__ - Epoch 10/300 Validation Loss: 0.062009
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 76.48it/s]
10/23/2025 09:04:34 - INFO - __main__ - Epoch 11/300██████████████████████████████████████████████████████████████████████████▎| 496/499 [00:06<00:00, 76.55it/s]
  4%|████▎                                                                                                               | 8590/234300 [14:16<5:16:15, 11.89it/s]10/23/2025 09:05:40 - INFO - __main__ - Epoch 11/300, Step 780/781, Loss 0.07579652965068817 (0.06268306183372356)
10/23/2025 09:05:43 - INFO - __main__ - Epoch 11/300 Validation Loss: 0.060978
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 74.66it/s]
10/23/2025 09:05:49 - INFO - __main__ - Epoch 12/300██████████████████████████████████████████████████████████████████████████▎| 496/499 [00:06<00:00, 75.08it/s]
  4%|████▋                                                                                                               | 9372/234300 [15:31<5:09:00, 12.13it/s]10/23/2025 09:06:55 - INFO - __main__ - Epoch 12/300, Step 780/781, Loss 0.07536555081605911 (0.06152697913491772)
10/23/2025 09:06:58 - INFO - __main__ - Epoch 12/300 Validation Loss: 0.060289
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:08<00:00, 61.57it/s]
10/23/2025 09:07:06 - INFO - __main__ - Epoch 13/300██████████████████████████████████████████████████████████████████████████▎| 496/499 [00:08<00:00, 61.63it/s]
  4%|████▉                                                                                                              | 10152/234300 [16:47<5:13:37, 11.91it/s]10/23/2025 09:08:12 - INFO - __main__ - Epoch 13/300, Step 780/781, Loss 0.056035976856946945 (0.06241022657111726)
10/23/2025 09:08:14 - INFO - __main__ - Epoch 13/300 Validation Loss: 0.061413
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:08<00:00, 58.94it/s]
10/23/2025 09:08:23 - INFO - __main__ - Epoch 14/300███████████████████████████████████████████████████████████████████████████| 499/499 [00:08<00:00, 59.28it/s]
  5%|█████▎                                                                                                             | 10934/234300 [18:04<5:12:08, 11.93it/s]10/23/2025 09:09:29 - INFO - __main__ - Epoch 14/300, Step 780/781, Loss 0.05849180743098259 (0.06175359873704507)
10/23/2025 09:09:31 - INFO - __main__ - Epoch 14/300 Validation Loss: 0.060162
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 75.22it/s]
10/23/2025 09:09:38 - INFO - __main__ - Epoch 15/300██████████████████████████████████████████████████████████████████████████▎| 496/499 [00:06<00:00, 74.64it/s]
  5%|█████▋                                                                                                             | 11714/234300 [19:20<5:13:35, 11.83it/s]10/23/2025 09:10:44 - INFO - __main__ - Epoch 15/300, Step 780/781, Loss 0.08460210263729095 (0.06089618594580057)
10/23/2025 09:10:47 - INFO - __main__ - Epoch 15/300 Validation Loss: 0.060824
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 78.50it/s]
10/23/2025 09:10:53 - INFO - __main__ - Epoch 16/300██████████████████████████████████████████████████████████████████████████▎| 496/499 [00:06<00:00, 78.15it/s]
  5%|██████▏                                                                                                            | 12496/234300 [20:35<5:10:44, 11.90it/s]10/23/2025 09:11:59 - INFO - __main__ - Epoch 16/300, Step 780/781, Loss 0.08166821300983429 (0.061192842751321655)
10/23/2025 09:12:02 - INFO - __main__ - Epoch 16/300 Validation Loss: 0.058793
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:08<00:00, 58.66it/s]
10/23/2025 09:12:10 - INFO - __main__ - Epoch 17/300██████████████████████████████████████████████████████████████████████████▊| 498/499 [00:08<00:00, 59.03it/s]
  6%|██████▌                                                                                                            | 13276/234300 [21:52<5:10:06, 11.88it/s]10/23/2025 09:13:16 - INFO - __main__ - Epoch 17/300, Step 780/781, Loss 0.04167202115058899 (0.06001021409175918)
10/23/2025 09:13:19 - INFO - __main__ - Epoch 17/300 Validation Loss: 0.059077
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 74.24it/s]
10/23/2025 09:13:25 - INFO - __main__ - Epoch 18/300██████████████████████████████████████████████████████████████████████████▎| 496/499 [00:06<00:00, 74.37it/s]
  6%|██████▉                                                                                                            | 14058/234300 [23:08<5:08:02, 11.92it/s]10/23/2025 09:14:32 - INFO - __main__ - Epoch 18/300, Step 780/781, Loss 0.05478931590914726 (0.06041144054960197)
10/23/2025 09:14:35 - INFO - __main__ - Epoch 18/300 Validation Loss: 0.059267
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:08<00:00, 58.83it/s]
10/23/2025 09:14:43 - INFO - __main__ - Epoch 19/300██████████████████████████████████████████████████████████████████████████▌| 497/499 [00:08<00:00, 58.77it/s]
  6%|██████▉                                                                                                            | 14152/234300 [23:27<5:09:53, 11.84it/s]
