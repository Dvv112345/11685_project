10/21/2025 08:56:28 - INFO - __main__ - ***** Training arguments *****
10/21/2025 08:56:28 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', data_dir='/ocean/projects/cis250019p/jye9/11685-project/data', image_size=32, batch_size=64, num_workers=4, num_classes=10, run_name='exp-5-ddpm', output_dir='/ocean/projects/cis250019p/jye9/11685-project/experiments', num_epochs=100, learning_rate=0.0001, weight_decay=0.01, grad_clip=1.0, seed=42, mixed_precision='none', num_train_timesteps=1000, num_inference_steps=1000, beta_start=0.0001, beta_end=0.008, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, optimizer_type='AdamW', scheduler_type='ConsineAnnealingLR', unet_in_size=32, unet_in_ch=3, unet_ch=64, unet_ch_mult=[1, 2, 2, 4], unet_attn=[2, 3], unet_num_res_blocks=1, unet_dropout=0.2, latent_ddpm=True, pretrained_vae='/ocean/projects/cis250019p/jye9/11685-project/pretrained/model.ckpt', use_cfg=False, cfg_guidance_scale=2.0, use_ddim=False, ckpt=None, predictor_type='epsilon', distributed=False, world_size=1, rank=0, local_rank=0, device='cuda', total_batch_size=64, max_train_steps=78100)
10/21/2025 08:56:28 - INFO - __main__ - ***** Running training *****
10/21/2025 08:56:28 - INFO - __main__ -   Num examples = 50000
10/21/2025 08:56:28 - INFO - __main__ -   Num Epochs = 100
10/21/2025 08:56:28 - INFO - __main__ -   Instantaneous batch size per device = 64
10/21/2025 08:56:28 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 64
10/21/2025 08:56:28 - INFO - __main__ -   Total optimization steps per epoch 781
10/21/2025 08:56:28 - INFO - __main__ -   Total optimization steps = 78100
  0%|                                                                                     | 0/78100 [00:00<?, ?it/s]10/21/2025 08:56:28 - INFO - __main__ - Epoch 1/100
  0%|                                                                         | 1/78100 [00:14<323:20:56, 14.90s/it]10/21/2025 08:56:43 - INFO - __main__ - Epoch 1/100, Step 0/781, Loss 0.9900727272033691 (0.9900727272033691)
  0%|                                                                            | 99/78100 [00:19<58:18, 22.29it/s]10/21/2025 08:56:48 - INFO - __main__ - Epoch 1/100, Step 100/781, Loss 0.8533127307891846 (0.913677723691015)
  0%|▏                                                                          | 201/78100 [00:24<58:02, 22.37it/s]10/21/2025 08:56:52 - INFO - __main__ - Epoch 1/100, Step 200/781, Loss 0.6985704898834229 (0.8640861250274811)
  0%|▎                                                                          | 300/78100 [00:28<59:20, 21.85it/s]10/21/2025 08:56:57 - INFO - __main__ - Epoch 1/100, Step 300/781, Loss 0.5668991208076477 (0.7795230696763708)
  1%|▍                                                                          | 399/78100 [00:32<58:10, 22.26it/s]10/21/2025 08:57:01 - INFO - __main__ - Epoch 1/100, Step 400/781, Loss 0.49029549956321716 (0.7193699948062326)
  1%|▍                                                                          | 501/78100 [00:37<58:08, 22.24it/s]10/21/2025 08:57:06 - INFO - __main__ - Epoch 1/100, Step 500/781, Loss 0.4586741626262665 (0.6603730677249665)
  1%|▌                                                                          | 600/78100 [00:42<57:43, 22.37it/s]10/21/2025 08:57:10 - INFO - __main__ - Epoch 1/100, Step 600/781, Loss 0.40535563230514526 (0.6143261435722154)
  1%|▋                                                                          | 699/78100 [00:46<57:54, 22.28it/s]10/21/2025 08:57:15 - INFO - __main__ - Epoch 1/100, Step 700/781, Loss 0.34239721298217773 (0.5758428659061563)
100%|████████████████████████████████████████████████████████████████████████████| 999/999 [00:08<00:00, 123.03it/s]
  1%|▊                                                                          | 781/78100 [01:02<57:39, 22.35it/s]10/21/2025 08:57:36 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
10/21/2025 08:57:36 - INFO - numexpr.utils - NumExpr defaulting to 16 threads.
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-5-ddpm/checkpoints/checkpoint_epoch_0.pth
10/21/2025 08:57:43 - INFO - __main__ - Epoch 2/100
  1%|▋                                                                       | 782/78100 [01:14<59:05:24,  2.75s/it]10/21/2025 08:57:43 - INFO - __main__ - Epoch 2/100, Step 0/781, Loss 0.39985746145248413 (0.39985746145248413)
  1%|▊                                                                          | 880/78100 [01:18<57:50, 22.25it/s]10/21/2025 08:57:47 - INFO - __main__ - Epoch 2/100, Step 100/781, Loss 0.34154459834098816 (0.3155315338384987)
  1%|▉                                                                          | 982/78100 [01:23<58:04, 22.13it/s]10/21/2025 08:57:52 - INFO - __main__ - Epoch 2/100, Step 200/781, Loss 0.35042399168014526 (0.31356558819018787)
  1%|█                                                                         | 1081/78100 [01:28<57:38, 22.27it/s]10/21/2025 08:57:56 - INFO - __main__ - Epoch 2/100, Step 300/781, Loss 0.27768412232398987 (0.3090621679526231)
  2%|█                                                                         | 1180/78100 [01:32<58:35, 21.88it/s]10/21/2025 08:58:01 - INFO - __main__ - Epoch 2/100, Step 400/781, Loss 0.3200228214263916 (0.30684433223452057)
  2%|█▏                                                                        | 1282/78100 [01:37<57:20, 22.33it/s]10/21/2025 08:58:05 - INFO - __main__ - Epoch 2/100, Step 500/781, Loss 0.32491421699523926 (0.30602762352920576)
  2%|█▎                                                                        | 1381/78100 [01:41<57:42, 22.16it/s]10/21/2025 08:58:10 - INFO - __main__ - Epoch 2/100, Step 600/781, Loss 0.33150944113731384 (0.3047231380733198)
  2%|█▍                                                                        | 1480/78100 [01:46<57:26, 22.23it/s]10/21/2025 08:58:14 - INFO - __main__ - Epoch 2/100, Step 700/781, Loss 0.3339000940322876 (0.3031834008945378)
  2%|█▍                                                                        | 1543/78100 [01:48<57:32, 22.17it/s]
