10/22/2025 15:40:48 - INFO - __main__ - ***** Training arguments *****
10/22/2025 15:40:48 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', data_dir='/ocean/projects/cis250019p/jye9/11685-project/data', is_cifar_10=True, image_size=32, batch_size=32, num_workers=4, num_classes=10, run_name='exp-8-ddpm', output_dir='/ocean/projects/cis250019p/jye9/11685-project/experiments', num_epochs=300, learning_rate=0.0005, weight_decay=0, grad_clip=1.0, seed=42, mixed_precision='none', use_val=True, num_train_timesteps=1000, num_inference_steps=100, beta_start=0.0001, beta_end=0.02, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, optimizer_type='AdamW', scheduler_type='ConsineAnnealingLR', unet_in_size=32, unet_in_ch=3, unet_ch=128, unet_ch_mult=[1, 2, 2, 2], unet_attn=[2], unet_num_res_blocks=2, unet_dropout=0.1, latent_ddpm=False, pretrained_vae='/ocean/projects/cis250019p/jye9/11685-project/pretrained/model.ckpt', use_cfg=False, cfg_guidance_scale=2.0, use_ddim=False, ckpt=None, device='cuda', rank=0, world_size=1, predictor_type='epsilon', distributed=False, local_rank=0, total_batch_size=32, max_train_steps=468600)
10/22/2025 15:40:48 - INFO - __main__ - ***** Running training *****
10/22/2025 15:40:48 - INFO - __main__ -   Num examples = 50000
10/22/2025 15:40:48 - INFO - __main__ -   Num Epochs = 300
10/22/2025 15:40:48 - INFO - __main__ -   Instantaneous batch size per device = 32
10/22/2025 15:40:48 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 32
10/22/2025 15:40:48 - INFO - __main__ -   Total optimization steps per epoch 1562
10/22/2025 15:40:48 - INFO - __main__ -   Total optimization steps = 468600
  0%|                                                                                                                                 | 0/468600 [00:00<?, ?it/s]10/22/2025 15:40:48 - INFO - __main__ - Epoch 1/300
  0%|▍                                                                                                                  | 1561/468600 [02:37<12:05:14, 10.73it/s]10/22/2025 15:43:25 - INFO - __main__ - Epoch 1/300, Step 1561/1562, Loss 0.0543767511844635 (0.06346825372830758)
10/22/2025 15:43:28 - INFO - __main__ - Epoch 1/300 Validation Loss: 0.035217
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 61.10it/s]
10/22/2025 15:43:37 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.1<00:00, 87.58it/s]
10/22/2025 15:43:37 - INFO - numexpr.utils - NumExpr defaulting to 16 threads.
  0%|▍                                                                                                                  | 1562/468600 [02:50<12:05:14, 10.73it/s]10/22/2025 15:43:42 - INFO - __main__ - Epoch 2/300
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-8-ddpm/checkpoints/checkpoint_epoch_0.pth
  1%|▊                                                                                                                  | 3123/468600 [05:19<12:02:53, 10.73it/s]10/22/2025 15:46:08 - INFO - __main__ - Epoch 2/300, Step 1561/1562, Loss 0.021495509892702103 (0.03744345018759408)
10/22/2025 15:46:10 - INFO - __main__ - Epoch 2/300 Validation Loss: 0.032474
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 91.02it/s]
10/22/2025 15:46:11 - INFO - __main__ - Epoch 3/300█████████████████████████████████████████████████████████████████████████▎   | 97/100 [00:01<00:00, 91.63it/s]
  1%|█▏                                                                                                                 | 4685/468600 [07:48<12:01:43, 10.71it/s]10/22/2025 15:48:37 - INFO - __main__ - Epoch 3/300, Step 1561/1562, Loss 0.026259897276759148 (0.035233816050264925)
10/22/2025 15:48:39 - INFO - __main__ - Epoch 3/300 Validation Loss: 0.035191
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 94.19it/s]
10/22/2025 15:48:40 - INFO - __main__ - Epoch 4/300████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 94.21it/s]
  1%|█▌                                                                                                                 | 6247/468600 [10:17<11:57:05, 10.75it/s]10/22/2025 15:51:06 - INFO - __main__ - Epoch 4/300, Step 1561/1562, Loss 0.0288885198533535 (0.03450724395545302)
10/22/2025 15:51:08 - INFO - __main__ - Epoch 4/300 Validation Loss: 0.030723
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 87.99it/s]
10/22/2025 15:51:10 - INFO - __main__ - Epoch 5/300████████████████████████████████████████████████████████████████████▍        | 93/100 [00:01<00:00, 86.71it/s]
  2%|█▉                                                                                                                 | 7809/468600 [12:46<11:52:46, 10.77it/s]10/22/2025 15:53:35 - INFO - __main__ - Epoch 5/300, Step 1561/1562, Loss 0.0424538180232048 (0.03333960733139141)
10/22/2025 15:53:38 - INFO - __main__ - Epoch 5/300 Validation Loss: 0.034560
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 87.28it/s]
10/22/2025 15:53:39 - INFO - __main__ - Epoch 6/300███████████████████████████████████████████████████████████████████████████▊ | 99/100 [00:01<00:00, 87.92it/s]
  2%|██▎                                                                                                                | 9371/468600 [15:16<11:52:55, 10.74it/s]10/22/2025 15:56:05 - INFO - __main__ - Epoch 6/300, Step 1561/1562, Loss 0.04391553997993469 (0.033210388737731876)
10/22/2025 15:56:07 - INFO - __main__ - Epoch 6/300 Validation Loss: 0.031740
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 89.53it/s]
10/22/2025 15:56:08 - INFO - __main__ - Epoch 7/300██████████████████████████████████████████████████████████████████████▊      | 95/100 [00:01<00:00, 91.03it/s]
  2%|██▋                                                                                                               | 10933/468600 [17:45<11:51:18, 10.72it/s]10/22/2025 15:58:34 - INFO - __main__ - Epoch 7/300, Step 1561/1562, Loss 0.04669228196144104 (0.032272443096016304)
10/22/2025 15:58:36 - INFO - __main__ - Epoch 7/300 Validation Loss: 0.034417
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 89.82it/s]
10/22/2025 15:58:37 - INFO - __main__ - Epoch 8/300██████████████████████████████████████████████████████████████████████▊      | 95/100 [00:01<00:00, 90.40it/s]
  3%|███                                                                                                               | 12495/468600 [20:14<11:49:36, 10.71it/s]10/22/2025 16:01:03 - INFO - __main__ - Epoch 8/300, Step 1561/1562, Loss 0.02610766887664795 (0.03255775867974464)
10/22/2025 16:01:06 - INFO - __main__ - Epoch 8/300 Validation Loss: 0.031892
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 87.77it/s]
10/22/2025 16:01:07 - INFO - __main__ - Epoch 9/300███████████████████████████████████████████████████████████████████████████▊ | 99/100 [00:01<00:00, 87.34it/s]
  3%|███▍                                                                                                              | 14057/468600 [22:44<11:46:01, 10.73it/s]10/22/2025 16:03:32 - INFO - __main__ - Epoch 9/300, Step 1561/1562, Loss 0.028286738321185112 (0.032209080675850585)
10/22/2025 16:03:35 - INFO - __main__ - Epoch 9/300 Validation Loss: 0.029858
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 91.04it/s]
10/22/2025 16:03:36 - INFO - __main__ - Epoch 10/300██████████████████████████████████████████████████████████████████████████▊ | 99/100 [00:01<00:00, 90.89it/s]
  3%|███▊                                                                                                              | 15619/468600 [25:13<11:40:07, 10.78it/s]10/22/2025 16:06:01 - INFO - __main__ - Epoch 10/300, Step 1561/1562, Loss 0.028628218919038773 (0.031878690775507694)
10/22/2025 16:06:04 - INFO - __main__ - Epoch 10/300 Validation Loss: 0.032494
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 87.29it/s]
10/22/2025 16:06:05 - INFO - __main__ - Epoch 11/300██████████████████████████████████████████████████████████████████▏         | 92/100 [00:01<00:00, 87.96it/s]
  4%|████▏                                                                                                             | 17181/468600 [27:42<11:41:45, 10.72it/s]10/22/2025 16:08:31 - INFO - __main__ - Epoch 11/300, Step 1561/1562, Loss 0.05291002243757248 (0.03203272036122928)
10/22/2025 16:08:33 - INFO - __main__ - Epoch 11/300 Validation Loss: 0.031961
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 90.17it/s]
10/22/2025 16:08:34 - INFO - __main__ - Epoch 12/300██████████████████████████████████████████████████████████████████████████▊ | 99/100 [00:01<00:00, 90.17it/s]
  4%|████▌                                                                                                             | 18744/468600 [30:14<17:17:49,  7.22it/s]10/22/2025 16:11:02 - INFO - __main__ - Epoch 12/300, Step 1561/1562, Loss 0.02922729216516018 (0.031696468888019975)
10/22/2025 16:11:05 - INFO - __main__ - Epoch 12/300 Validation Loss: 0.028806
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 91.91it/s]
10/22/2025 16:11:06 - INFO - __main__ - Epoch 13/300██████████████████████████████████████████████████████████████████████████▊ | 99/100 [00:01<00:00, 92.34it/s]
  4%|████▉                                                                                                             | 20306/468600 [32:42<11:31:39, 10.80it/s]10/22/2025 16:13:31 - INFO - __main__ - Epoch 13/300, Step 1561/1562, Loss 0.04004623740911484 (0.030793673848666527)
10/22/2025 16:13:33 - INFO - __main__ - Epoch 13/300 Validation Loss: 0.032809
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 96.21it/s]
10/22/2025 16:13:35 - INFO - __main__ - Epoch 14/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 96.55it/s]
  5%|█████▎                                                                                                            | 21868/468600 [35:11<11:29:49, 10.79it/s]10/22/2025 16:15:59 - INFO - __main__ - Epoch 14/300, Step 1561/1562, Loss 0.03862651810050011 (0.031164458726870226)
10/22/2025 16:16:02 - INFO - __main__ - Epoch 14/300 Validation Loss: 0.030579
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 91.53it/s]
10/22/2025 16:16:03 - INFO - __main__ - Epoch 15/300██████████████████████████████████████████████████████████████████████████▊ | 99/100 [00:01<00:00, 92.54it/s]
  5%|█████▋                                                                                                            | 23430/468600 [37:39<11:26:43, 10.80it/s]10/22/2025 16:18:28 - INFO - __main__ - Epoch 15/300, Step 1561/1562, Loss 0.01845415309071541 (0.031350006773309465)
10/22/2025 16:18:30 - INFO - __main__ - Epoch 15/300 Validation Loss: 0.031134
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 96.98it/s]
10/22/2025 16:18:31 - INFO - __main__ - Epoch 16/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 97.26it/s]
  5%|██████                                                                                                            | 24992/468600 [40:07<11:24:28, 10.80it/s]10/22/2025 16:20:56 - INFO - __main__ - Epoch 16/300, Step 1561/1562, Loss 0.015253854915499687 (0.03144688528954086)
10/22/2025 16:20:59 - INFO - __main__ - Epoch 16/300 Validation Loss: 0.027476
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 88.11it/s]
10/22/2025 16:21:00 - INFO - __main__ - Epoch 17/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 88.41it/s]
  6%|██████▍                                                                                                           | 26554/468600 [42:36<11:22:41, 10.79it/s]10/22/2025 16:23:25 - INFO - __main__ - Epoch 17/300, Step 1561/1562, Loss 0.03000086173415184 (0.030871731661398456)
10/22/2025 16:23:27 - INFO - __main__ - Epoch 17/300 Validation Loss: 0.033314
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 93.69it/s]
10/22/2025 16:23:28 - INFO - __main__ - Epoch 18/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 93.99it/s]
  6%|██████▊                                                                                                           | 28116/468600 [45:05<11:20:47, 10.78it/s]10/22/2025 16:25:53 - INFO - __main__ - Epoch 18/300, Step 1561/1562, Loss 0.03292452543973923 (0.030495748345092624)
10/22/2025 16:25:56 - INFO - __main__ - Epoch 18/300 Validation Loss: 0.031216
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 92.36it/s]
10/22/2025 16:25:57 - INFO - __main__ - Epoch 19/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 92.45it/s]
  6%|███████▏                                                                                                          | 29678/468600 [47:34<11:21:19, 10.74it/s]10/22/2025 16:28:22 - INFO - __main__ - Epoch 19/300, Step 1561/1562, Loss 0.03825769200921059 (0.031306292974388895)
10/22/2025 16:28:25 - INFO - __main__ - Epoch 19/300 Validation Loss: 0.030908
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 92.11it/s]
10/22/2025 16:28:26 - INFO - __main__ - Epoch 20/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 92.44it/s]
  7%|███████▌                                                                                                          | 31240/468600 [50:02<11:17:38, 10.76it/s]10/22/2025 16:30:51 - INFO - __main__ - Epoch 20/300, Step 1561/1562, Loss 0.030628066509962082 (0.030665174388969447)
10/22/2025 16:30:54 - INFO - __main__ - Epoch 20/300 Validation Loss: 0.029660
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 89.57it/s]
10/22/2025 16:30:55 - INFO - __main__ - Epoch 21/300████████████████████████████████████████████████████████████████████▌       | 94/100 [00:01<00:00, 91.78it/s]
  7%|███████▉                                                                                                          | 32802/468600 [52:31<11:12:50, 10.79it/s]10/22/2025 16:33:20 - INFO - __main__ - Epoch 21/300, Step 1561/1562, Loss 0.012190928682684898 (0.030554713638411137)
10/22/2025 16:33:22 - INFO - __main__ - Epoch 21/300 Validation Loss: 0.027479
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.36it/s]
10/22/2025 16:33:23 - INFO - __main__ - Epoch 22/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.70it/s]
  7%|████████▎                                                                                                         | 34364/468600 [54:59<11:10:29, 10.79it/s]10/22/2025 16:35:48 - INFO - __main__ - Epoch 22/300, Step 1561/1562, Loss 0.04281563684344292 (0.030463615458616068)
10/22/2025 16:35:50 - INFO - __main__ - Epoch 22/300 Validation Loss: 0.030934
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 92.71it/s]
10/22/2025 16:35:52 - INFO - __main__ - Epoch 23/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 92.97it/s]
  8%|████████▋                                                                                                         | 35926/468600 [57:28<11:07:33, 10.80it/s]10/22/2025 16:38:17 - INFO - __main__ - Epoch 23/300, Step 1561/1562, Loss 0.03341224044561386 (0.031126313697947394)
10/22/2025 16:38:19 - INFO - __main__ - Epoch 23/300 Validation Loss: 0.028333
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.49it/s]
10/22/2025 16:38:20 - INFO - __main__ - Epoch 24/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.75it/s]
  8%|█████████                                                                                                         | 37488/468600 [59:57<11:08:43, 10.74it/s]10/22/2025 16:40:45 - INFO - __main__ - Epoch 24/300, Step 1561/1562, Loss 0.019822578877210617 (0.03052937633133757)
10/22/2025 16:40:48 - INFO - __main__ - Epoch 24/300 Validation Loss: 0.029244
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 91.77it/s]
10/22/2025 16:40:49 - INFO - __main__ - Epoch 25/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 91.51it/s]
  8%|█████████▎                                                                                                      | 39050/468600 [1:02:25<11:02:41, 10.80it/s]10/22/2025 16:43:14 - INFO - __main__ - Epoch 25/300, Step 1561/1562, Loss 0.05598316341638565 (0.03055159957476065)
10/22/2025 16:43:16 - INFO - __main__ - Epoch 25/300 Validation Loss: 0.031369
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.52it/s]
10/22/2025 16:43:17 - INFO - __main__ - Epoch 26/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.74it/s]
  9%|█████████▋                                                                                                      | 40612/468600 [1:04:54<11:11:31, 10.62it/s]10/22/2025 16:45:43 - INFO - __main__ - Epoch 26/300, Step 1561/1562, Loss 0.018052492290735245 (0.030143608711182917)
10/22/2025 16:45:48 - INFO - __main__ - Epoch 26/300 Validation Loss: 0.029519
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 79.16it/s]
10/22/2025 16:45:49 - INFO - __main__ - Epoch 27/300██████████████████████████████████████████████████████████████████▏         | 92/100 [00:01<00:00, 94.37it/s]
  9%|██████████                                                                                                      | 42174/468600 [1:07:25<10:58:12, 10.80it/s]10/22/2025 16:48:14 - INFO - __main__ - Epoch 27/300, Step 1561/1562, Loss 0.0351148322224617 (0.03037225950459226)
10/22/2025 16:48:16 - INFO - __main__ - Epoch 27/300 Validation Loss: 0.030575
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 92.84it/s]
10/22/2025 16:48:18 - INFO - __main__ - Epoch 28/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 93.48it/s]
  9%|██████████▍                                                                                                     | 43736/468600 [1:09:57<10:55:07, 10.81it/s]10/22/2025 16:50:45 - INFO - __main__ - Epoch 28/300, Step 1561/1562, Loss 0.035539764910936356 (0.029730488665738214)
10/22/2025 16:50:48 - INFO - __main__ - Epoch 28/300 Validation Loss: 0.031992
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 89.75it/s]
10/22/2025 16:50:49 - INFO - __main__ - Epoch 29/300████████████████████████████████████████████████████████████████▉           | 91/100 [00:01<00:00, 97.91it/s]
 10%|██████████▊                                                                                                     | 45298/468600 [1:12:27<10:53:27, 10.80it/s]10/22/2025 16:53:15 - INFO - __main__ - Epoch 29/300, Step 1561/1562, Loss 0.033963218331336975 (0.03055033499342789)
10/22/2025 16:53:18 - INFO - __main__ - Epoch 29/300 Validation Loss: 0.030687
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.50it/s]
10/22/2025 16:53:19 - INFO - __main__ - Epoch 30/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.43it/s]
 10%|███████████▏                                                                                                    | 46860/468600 [1:14:55<10:51:47, 10.78it/s]10/22/2025 16:55:44 - INFO - __main__ - Epoch 30/300, Step 1561/1562, Loss 0.031861312687397 (0.02986774473956687)
10/22/2025 16:55:46 - INFO - __main__ - Epoch 30/300 Validation Loss: 0.031745
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 94.93it/s]
10/22/2025 16:55:47 - INFO - __main__ - Epoch 31/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.13it/s]
 10%|███████████▌                                                                                                    | 48422/468600 [1:17:23<10:47:59, 10.81it/s]10/22/2025 16:58:12 - INFO - __main__ - Epoch 31/300, Step 1561/1562, Loss 0.03261011093854904 (0.03000661299299215)
10/22/2025 16:58:15 - INFO - __main__ - Epoch 31/300 Validation Loss: 0.030177
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.34it/s]
10/22/2025 16:58:16 - INFO - __main__ - Epoch 32/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.69it/s]
 11%|███████████▉                                                                                                    | 49984/468600 [1:19:52<10:46:13, 10.80it/s]10/22/2025 17:00:40 - INFO - __main__ - Epoch 32/300, Step 1561/1562, Loss 0.020715264603495598 (0.029604831460634397)
10/22/2025 17:00:43 - INFO - __main__ - Epoch 32/300 Validation Loss: 0.028273
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.34it/s]
10/22/2025 17:00:44 - INFO - __main__ - Epoch 33/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.54it/s]
 11%|████████████▎                                                                                                   | 51546/468600 [1:22:20<10:43:05, 10.81it/s]10/22/2025 17:03:09 - INFO - __main__ - Epoch 33/300, Step 1561/1562, Loss 0.02593570575118065 (0.030047123440244402)
10/22/2025 17:03:11 - INFO - __main__ - Epoch 33/300 Validation Loss: 0.028568
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.46it/s]
10/22/2025 17:03:12 - INFO - __main__ - Epoch 34/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 96.09it/s]
 11%|████████████▋                                                                                                   | 53108/468600 [1:24:49<10:41:35, 10.79it/s]10/22/2025 17:05:38 - INFO - __main__ - Epoch 34/300, Step 1561/1562, Loss 0.02808815985918045 (0.029772754118833858)
10/22/2025 17:05:40 - INFO - __main__ - Epoch 34/300 Validation Loss: 0.028018
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 93.66it/s]
10/22/2025 17:05:41 - INFO - __main__ - Epoch 35/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 94.26it/s]
 12%|█████████████                                                                                                   | 54670/468600 [1:27:17<10:39:00, 10.80it/s]10/22/2025 17:08:06 - INFO - __main__ - Epoch 35/300, Step 1561/1562, Loss 0.026441659778356552 (0.030102450369288443)
10/22/2025 17:08:09 - INFO - __main__ - Epoch 35/300 Validation Loss: 0.030416
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 96.68it/s]
10/22/2025 17:08:10 - INFO - __main__ - Epoch 36/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 97.27it/s]
 12%|█████████████▍                                                                                                  | 56232/468600 [1:29:46<10:36:59, 10.79it/s]10/22/2025 17:10:34 - INFO - __main__ - Epoch 36/300, Step 1561/1562, Loss 0.04706783592700958 (0.029734301760616245)
10/22/2025 17:10:37 - INFO - __main__ - Epoch 36/300 Validation Loss: 0.028847
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 94.21it/s]
10/22/2025 17:10:38 - INFO - __main__ - Epoch 37/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 94.63it/s]
 12%|█████████████▊                                                                                                  | 57794/468600 [1:32:14<10:35:55, 10.77it/s]10/22/2025 17:13:03 - INFO - __main__ - Epoch 37/300, Step 1561/1562, Loss 0.056229542940855026 (0.029813751629607397)
10/22/2025 17:13:06 - INFO - __main__ - Epoch 37/300 Validation Loss: 0.028389
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 91.54it/s]
10/22/2025 17:13:07 - INFO - __main__ - Epoch 38/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 92.12it/s]
 13%|██████████████▏                                                                                                 | 59356/468600 [1:34:43<10:31:57, 10.79it/s]10/22/2025 17:15:31 - INFO - __main__ - Epoch 38/300, Step 1561/1562, Loss 0.015442617237567902 (0.030087697942158095)
10/22/2025 17:15:34 - INFO - __main__ - Epoch 38/300 Validation Loss: 0.027875
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.54it/s]
10/22/2025 17:15:35 - INFO - __main__ - Epoch 39/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.85it/s]
 13%|██████████████▌                                                                                                 | 60918/468600 [1:37:12<10:28:56, 10.80it/s]10/22/2025 17:18:00 - INFO - __main__ - Epoch 39/300, Step 1561/1562, Loss 0.019231382757425308 (0.029739462821798044)
10/22/2025 17:18:03 - INFO - __main__ - Epoch 39/300 Validation Loss: 0.028998
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.67it/s]
10/22/2025 17:18:04 - INFO - __main__ - Epoch 40/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 96.04it/s]
 13%|██████████████▉                                                                                                 | 62480/468600 [1:39:40<10:27:12, 10.79it/s]10/22/2025 17:20:29 - INFO - __main__ - Epoch 40/300, Step 1561/1562, Loss 0.029168402776122093 (0.029974648447542735)
10/22/2025 17:20:31 - INFO - __main__ - Epoch 40/300 Validation Loss: 0.030130
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.76it/s]
10/22/2025 17:20:32 - INFO - __main__ - Epoch 41/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 96.15it/s]
 14%|███████████████▎                                                                                                | 64042/468600 [1:42:09<10:24:38, 10.79it/s]10/22/2025 17:22:57 - INFO - __main__ - Epoch 41/300, Step 1561/1562, Loss 0.04862937331199646 (0.03016111860290246)
10/22/2025 17:23:00 - INFO - __main__ - Epoch 41/300 Validation Loss: 0.028969
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.80it/s]
10/22/2025 17:23:01 - INFO - __main__ - Epoch 42/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 96.10it/s]
 14%|███████████████▋                                                                                                | 65604/468600 [1:44:37<10:22:03, 10.80it/s]10/22/2025 17:25:26 - INFO - __main__ - Epoch 42/300, Step 1561/1562, Loss 0.051672305911779404 (0.030240466748155587)
10/22/2025 17:25:28 - INFO - __main__ - Epoch 42/300 Validation Loss: 0.029318
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 97.31it/s]
10/22/2025 17:25:29 - INFO - __main__ - Epoch 43/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 97.76it/s]
 14%|████████████████                                                                                                | 67166/468600 [1:47:06<10:19:53, 10.79it/s]10/22/2025 17:27:54 - INFO - __main__ - Epoch 43/300, Step 1561/1562, Loss 0.01957608573138714 (0.029614950026410528)
10/22/2025 17:27:57 - INFO - __main__ - Epoch 43/300 Validation Loss: 0.029789
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.88it/s]
10/22/2025 17:27:58 - INFO - __main__ - Epoch 44/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 96.32it/s]
 15%|████████████████▍                                                                                               | 68728/468600 [1:49:34<10:17:27, 10.79it/s]10/22/2025 17:30:23 - INFO - __main__ - Epoch 44/300, Step 1561/1562, Loss 0.02790658175945282 (0.030105233906736067)
10/22/2025 17:30:25 - INFO - __main__ - Epoch 44/300 Validation Loss: 0.028988
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.42it/s]
10/22/2025 17:30:26 - INFO - __main__ - Epoch 45/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.61it/s]
 15%|████████████████▊                                                                                               | 70290/468600 [1:52:03<10:14:53, 10.80it/s]10/22/2025 17:32:52 - INFO - __main__ - Epoch 45/300, Step 1561/1562, Loss 0.03169293329119682 (0.029893560767312095)
10/22/2025 17:32:54 - INFO - __main__ - Epoch 45/300 Validation Loss: 0.030397
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.34it/s]
10/22/2025 17:32:55 - INFO - __main__ - Epoch 46/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.63it/s]
 15%|█████████████████▏                                                                                              | 71852/468600 [1:54:31<10:13:13, 10.78it/s]10/22/2025 17:35:20 - INFO - __main__ - Epoch 46/300, Step 1561/1562, Loss 0.020982403308153152 (0.030183671168725407)
10/22/2025 17:35:23 - INFO - __main__ - Epoch 46/300 Validation Loss: 0.029546
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.15it/s]
10/22/2025 17:35:24 - INFO - __main__ - Epoch 47/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.54it/s]
 16%|█████████████████▌                                                                                              | 73414/468600 [1:57:00<10:11:13, 10.78it/s]10/22/2025 17:37:48 - INFO - __main__ - Epoch 47/300, Step 1561/1562, Loss 0.029195591807365417 (0.02992373226489514)
10/22/2025 17:37:51 - INFO - __main__ - Epoch 47/300 Validation Loss: 0.029307
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 97.86it/s]
10/22/2025 17:37:52 - INFO - __main__ - Epoch 48/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.39it/s]
 16%|█████████████████▉                                                                                              | 74976/468600 [1:59:28<10:07:58, 10.79it/s]10/22/2025 17:40:17 - INFO - __main__ - Epoch 48/300, Step 1561/1562, Loss 0.02830430120229721 (0.030124966856497657)
10/22/2025 17:40:19 - INFO - __main__ - Epoch 48/300 Validation Loss: 0.029222
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 96.52it/s]
10/22/2025 17:40:20 - INFO - __main__ - Epoch 49/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 96.97it/s]
 16%|██████████████████▎                                                                                             | 76538/468600 [2:01:57<10:05:16, 10.80it/s]10/22/2025 17:42:45 - INFO - __main__ - Epoch 49/300, Step 1561/1562, Loss 0.03156494349241257 (0.03098817385563796)
10/22/2025 17:42:48 - INFO - __main__ - Epoch 49/300 Validation Loss: 0.032490
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.48it/s]
10/22/2025 17:42:49 - INFO - __main__ - Epoch 50/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.86it/s]
 17%|██████████████████▋                                                                                             | 78100/468600 [2:04:25<10:02:51, 10.80it/s]10/22/2025 17:45:14 - INFO - __main__ - Epoch 50/300, Step 1561/1562, Loss 0.03036310151219368 (0.030900149748072734)
10/22/2025 17:45:17 - INFO - __main__ - Epoch 50/300 Validation Loss: 0.031183
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.59it/s]
10/22/2025 17:45:18 - INFO - __main__ - Epoch 51/300███████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.81it/s]
 17%|███████████████████                                                                                             | 79662/468600 [2:06:54<10:02:17, 10.76it/s]10/22/2025 17:47:43 - INFO - __main__ - Epoch 51/300, Step 1561/1562, Loss 0.03371528536081314 (0.030103490628283016)
10/22/2025 17:47:46 - INFO - __main__ - Epoch 51/300 Validation Loss: 0.029468
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.89it/s]
Traceback (most recent call last):█████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 97.10it/s]
  File "/ocean/projects/cis250019p/jye9/conda/envs/11685/lib/python3.12/site-packages/torch/serialization.py", line 967, in save
    _save(
  File "/ocean/projects/cis250019p/jye9/conda/envs/11685/lib/python3.12/site-packages/torch/serialization.py", line 1268, in _save
    zip_file.write_record(name, storage, num_bytes)
RuntimeError: [enforce fail at inline_container.cc:858] . PytorchStreamWriter failed writing file data/1247: file write failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/jet/home/jye9/Project/11685_project/train.py", line 595, in <module>
    main()
  File "/jet/home/jye9/Project/11685_project/train.py", line 591, in main
    save_checkpoint(unet_wo_ddp, scheduler_wo_ddp, vae_wo_ddp, class_embedder, optimizer, epoch, save_dir=save_dir)
  File "/jet/home/jye9/Project/11685_project/utils/checkpoint.py", line 50, in save_checkpoint
    torch.save(checkpoint, checkpoint_path)
  File "/ocean/projects/cis250019p/jye9/conda/envs/11685/lib/python3.12/site-packages/torch/serialization.py", line 966, in save
    with _open_zipfile_writer(f) as opened_zipfile:
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/ocean/projects/cis250019p/jye9/conda/envs/11685/lib/python3.12/site-packages/torch/serialization.py", line 798, in __exit__
    self.file_like.write_end_of_file()
RuntimeError: [enforce fail at inline_container.cc:664] . unexpected pos 423705536 vs 423705424
