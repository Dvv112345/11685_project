10/22/2025 09:03:47 - INFO - __main__ - ***** Training arguments *****
10/22/2025 09:03:47 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', data_dir='/ocean/projects/cis250019p/jye9/11685-project/data', image_size=32, batch_size=64, num_workers=4, num_classes=10, run_name='exp-3-ddpm', output_dir='/ocean/projects/cis250019p/jye9/11685-project/experiments', num_epochs=30, learning_rate=0.0001, weight_decay=0.01, grad_clip=1.0, seed=42, mixed_precision='none', num_train_timesteps=1000, num_inference_steps=1000, beta_start=0.0001, beta_end=0.02, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, optimizer_type='AdamW', scheduler_type='ConsineAnnealingLR', unet_in_size=32, unet_in_ch=3, unet_ch=64, unet_ch_mult=[1, 2, 2, 4], unet_attn=[2, 3], unet_num_res_blocks=1, unet_dropout=0.2, latent_ddpm=False, pretrained_vae='/ocean/projects/cis250019p/jye9/11685-project/pretrained/model.ckpt', use_cfg=False, cfg_guidance_scale=2.0, use_ddim=False, ckpt=None, device='cuda', rank=0, world_size=1, predictor_type='epsilon', distributed=False, local_rank=0, total_batch_size=64, max_train_steps=23430)
10/22/2025 09:03:47 - INFO - __main__ - ***** Running training *****
10/22/2025 09:03:47 - INFO - __main__ -   Num examples = 50000
10/22/2025 09:03:47 - INFO - __main__ -   Num Epochs = 30
10/22/2025 09:03:47 - INFO - __main__ -   Instantaneous batch size per device = 64
10/22/2025 09:03:47 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 64
10/22/2025 09:03:47 - INFO - __main__ -   Total optimization steps per epoch 781
10/22/2025 09:03:47 - INFO - __main__ -   Total optimization steps = 23430
  0%|                                                                                                                                  | 0/23430 [00:00<?, ?it/s]10/22/2025 09:03:47 - INFO - __main__ - Epoch 1/30
  0%|                                                                                                                        | 1/23430 [00:00<4:42:34,  1.38it/s]10/22/2025 09:03:48 - INFO - __main__ - Epoch 1/30, Step 0/781, Loss 0.9998957514762878 (0.9998957514762878)
  0%|▌                                                                                                                       | 101/23430 [00:06<22:16, 17.45it/s]10/22/2025 09:03:54 - INFO - __main__ - Epoch 1/30, Step 100/781, Loss 0.8521026968955994 (0.9296081467430191)
  1%|█                                                                                                                       | 201/23430 [00:12<22:08, 17.48it/s]10/22/2025 09:03:59 - INFO - __main__ - Epoch 1/30, Step 200/781, Loss 0.6193992495536804 (0.8296833803404623)
  1%|█▌                                                                                                                      | 301/23430 [00:17<22:03, 17.48it/s]10/22/2025 09:04:05 - INFO - __main__ - Epoch 1/30, Step 300/781, Loss 0.45897728204727173 (0.7343364510425302)
  2%|██                                                                                                                      | 401/23430 [00:23<21:54, 17.52it/s]10/22/2025 09:04:11 - INFO - __main__ - Epoch 1/30, Step 400/781, Loss 0.31353649497032166 (0.6456598157894582)
  2%|██▌                                                                                                                     | 501/23430 [00:29<21:53, 17.45it/s]10/22/2025 09:04:16 - INFO - __main__ - Epoch 1/30, Step 500/781, Loss 0.19707131385803223 (0.5684104707248196)
  3%|███                                                                                                                     | 601/23430 [00:35<21:37, 17.60it/s]10/22/2025 09:04:22 - INFO - __main__ - Epoch 1/30, Step 600/781, Loss 0.1458687037229538 (0.5019582032711057)
  3%|███▌                                                                                                                    | 701/23430 [00:40<21:21, 17.74it/s]10/22/2025 09:04:28 - INFO - __main__ - Epoch 1/30, Step 700/781, Loss 0.08321547508239746 (0.4458447959959592)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 999/999 [00:08<00:00, 113.55it/s]
10/22/2025 09:04:41 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.<00:00, 114.41it/s]
10/22/2025 09:04:41 - INFO - numexpr.utils - NumExpr defaulting to 16 threads.
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-3-ddpm/checkpoints/checkpoint_epoch_0.pth
10/22/2025 09:04:42 - INFO - __main__ - Epoch 2/30
10/22/2025 09:04:42 - INFO - __main__ - Epoch 2/30, Step 0/781, Loss 0.06148837134242058 (0.06148837134242058)
  4%|████▌                                                                                                                   | 881/23430 [01:00<21:20, 17.61it/s]10/22/2025 09:04:48 - INFO - __main__ - Epoch 2/30, Step 100/781, Loss 0.056538891047239304 (0.06820032162831562)
  4%|█████                                                                                                                   | 981/23430 [01:06<21:13, 17.63it/s]10/22/2025 09:04:54 - INFO - __main__ - Epoch 2/30, Step 200/781, Loss 0.0652771145105362 (0.06300740783561522)
  5%|█████▍                                                                                                                 | 1081/23430 [01:12<21:08, 17.62it/s]10/22/2025 09:04:59 - INFO - __main__ - Epoch 2/30, Step 300/781, Loss 0.03490710258483887 (0.05912308622634292)
  5%|█████▉                                                                                                                 | 1181/23430 [01:17<21:00, 17.66it/s]10/22/2025 09:05:05 - INFO - __main__ - Epoch 2/30, Step 400/781, Loss 0.06832870841026306 (0.05644448958058607)
  5%|██████▌                                                                                                                | 1281/23430 [01:23<20:59, 17.58it/s]10/22/2025 09:05:11 - INFO - __main__ - Epoch 2/30, Step 500/781, Loss 0.061942052096128464 (0.05458411046800142)
  6%|███████                                                                                                                | 1381/23430 [01:29<20:52, 17.60it/s]10/22/2025 09:05:16 - INFO - __main__ - Epoch 2/30, Step 600/781, Loss 0.04659537598490715 (0.053082676185992314)
  6%|███████▌                                                                                                               | 1481/23430 [01:34<20:46, 17.60it/s]10/22/2025 09:05:22 - INFO - __main__ - Epoch 2/30, Step 700/781, Loss 0.06933777034282684 (0.05184701308023487)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 999/999 [00:08<00:00, 114.03it/s]
10/22/2025 09:05:35 - INFO - __main__ - Epoch 3/30███████████████████████████████████████████████████████████████████████████▋| 996/999 [00:08<00:00, 114.52it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-3-ddpm/checkpoints/checkpoint_epoch_1.pth
  7%|███████▊                                                                                                             | 1563/23430 [01:48<8:43:04,  1.44s/it]10/22/2025 09:05:36 - INFO - __main__ - Epoch 3/30, Step 0/781, Loss 0.06251649558544159 (0.06251649558544159)
  7%|████████▍                                                                                                              | 1663/23430 [01:54<20:31, 17.67it/s]10/22/2025 09:05:41 - INFO - __main__ - Epoch 3/30, Step 100/781, Loss 0.028403332456946373 (0.046277104222243376)
  8%|████████▉                                                                                                              | 1763/23430 [01:59<20:27, 17.65it/s]10/22/2025 09:05:47 - INFO - __main__ - Epoch 3/30, Step 200/781, Loss 0.04542753845453262 (0.04484128466441264)
  8%|█████████▍                                                                                                             | 1863/23430 [02:05<20:26, 17.59it/s]10/22/2025 09:05:53 - INFO - __main__ - Epoch 3/30, Step 300/781, Loss 0.03426295518875122 (0.04439013451956633)
  8%|█████████▉                                                                                                             | 1963/23430 [02:11<20:18, 17.62it/s]10/22/2025 09:05:58 - INFO - __main__ - Epoch 3/30, Step 400/781, Loss 0.050295330584049225 (0.043878447129727896)
  9%|██████████▍                                                                                                            | 2063/23430 [02:16<20:15, 17.58it/s]10/22/2025 09:06:04 - INFO - __main__ - Epoch 3/30, Step 500/781, Loss 0.04453591629862785 (0.043374475552709756)
  9%|██████████▉                                                                                                            | 2163/23430 [02:22<20:11, 17.55it/s]10/22/2025 09:06:10 - INFO - __main__ - Epoch 3/30, Step 600/781, Loss 0.04616185650229454 (0.043025970288526)
 10%|███████████▍                                                                                                           | 2263/23430 [02:28<20:07, 17.53it/s]10/22/2025 09:06:15 - INFO - __main__ - Epoch 3/30, Step 700/781, Loss 0.04532532021403313 (0.042886028943129)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 999/999 [00:08<00:00, 116.06it/s]
10/22/2025 09:06:29 - INFO - __main__ - Epoch 4/30███████████████████████████████████████████████████████████████████████████▋| 996/999 [00:08<00:00, 114.20it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-3-ddpm/checkpoints/checkpoint_epoch_2.pth
10/22/2025 09:06:29 - INFO - __main__ - Epoch 4/30, Step 0/781, Loss 0.02839774638414383 (0.02839774638414383)
 10%|████████████▍                                                                                                          | 2443/23430 [02:47<19:57, 17.53it/s]10/22/2025 09:06:35 - INFO - __main__ - Epoch 4/30, Step 100/781, Loss 0.04555916786193848 (0.03987985277677526)
 11%|████████████▉                                                                                                          | 2543/23430 [02:53<19:52, 17.51it/s]10/22/2025 09:06:41 - INFO - __main__ - Epoch 4/30, Step 200/781, Loss 0.04613595828413963 (0.04058086232685331)
 11%|█████████████▍                                                                                                         | 2643/23430 [02:59<19:45, 17.54it/s]10/22/2025 09:06:46 - INFO - __main__ - Epoch 4/30, Step 300/781, Loss 0.03348301723599434 (0.04044289427787759)
 12%|█████████████▉                                                                                                         | 2743/23430 [03:04<19:42, 17.49it/s]10/22/2025 09:06:52 - INFO - __main__ - Epoch 4/30, Step 400/781, Loss 0.03455401584506035 (0.04015511350515775)
 12%|██████████████▍                                                                                                        | 2843/23430 [03:10<19:37, 17.49it/s]10/22/2025 09:06:58 - INFO - __main__ - Epoch 4/30, Step 500/781, Loss 0.043703582137823105 (0.04051647043067538)
 13%|██████████████▉                                                                                                        | 2943/23430 [03:16<19:27, 17.54it/s]10/22/2025 09:07:03 - INFO - __main__ - Epoch 4/30, Step 600/781, Loss 0.038950685411691666 (0.040635460798633276)
 13%|███████████████▍                                                                                                       | 3043/23430 [03:22<19:19, 17.58it/s]10/22/2025 09:07:09 - INFO - __main__ - Epoch 4/30, Step 700/781, Loss 0.055899184197187424 (0.040219789532979104)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 999/999 [00:09<00:00, 107.31it/s]
10/22/2025 09:07:23 - INFO - __main__ - Epoch 5/30██████████████████████████████████████████████████████████████████████████▉ | 990/999 [00:09<00:00, 107.30it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-3-ddpm/checkpoints/checkpoint_epoch_3.pth
 13%|███████████████▌                                                                                                     | 3125/23430 [03:36<8:34:27,  1.52s/it]10/22/2025 09:07:24 - INFO - __main__ - Epoch 5/30, Step 0/781, Loss 0.02768900990486145 (0.02768900990486145)
 14%|████████████████▍                                                                                                      | 3225/23430 [03:42<19:13, 17.52it/s]10/22/2025 09:07:29 - INFO - __main__ - Epoch 5/30, Step 100/781, Loss 0.02926332876086235 (0.039567529860109384)
 14%|████████████████▉                                                                                                      | 3325/23430 [03:47<18:50, 17.79it/s]10/22/2025 09:07:35 - INFO - __main__ - Epoch 5/30, Step 200/781, Loss 0.04476058483123779 (0.0390810316697282)
 15%|█████████████████▍                                                                                                     | 3425/23430 [03:53<18:56, 17.60it/s]10/22/2025 09:07:41 - INFO - __main__ - Epoch 5/30, Step 300/781, Loss 0.04229205846786499 (0.039217488976362534)
 15%|█████████████████▉                                                                                                     | 3525/23430 [03:59<18:51, 17.59it/s]10/22/2025 09:07:46 - INFO - __main__ - Epoch 5/30, Step 400/781, Loss 0.03933636471629143 (0.03900289228487936)
 15%|██████████████████▍                                                                                                    | 3625/23430 [04:04<18:46, 17.58it/s]10/22/2025 09:07:52 - INFO - __main__ - Epoch 5/30, Step 500/781, Loss 0.044137559831142426 (0.03898205649769473)
 16%|██████████████████▉                                                                                                    | 3725/23430 [04:10<18:34, 17.68it/s]10/22/2025 09:07:58 - INFO - __main__ - Epoch 5/30, Step 600/781, Loss 0.05637219548225403 (0.039193537591425034)
 16%|███████████████████▍                                                                                                   | 3825/23430 [04:16<18:38, 17.53it/s]10/22/2025 09:08:03 - INFO - __main__ - Epoch 5/30, Step 700/781, Loss 0.044408392161130905 (0.03892117871845755)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 999/999 [00:08<00:00, 111.67it/s]
10/22/2025 09:08:17 - INFO - __main__ - Epoch 6/30███████████████████████████████████████████████████████████████████████████▍| 994/999 [00:08<00:00, 109.04it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-3-ddpm/checkpoints/checkpoint_epoch_4.pth
10/22/2025 09:08:17 - INFO - __main__ - Epoch 6/30, Step 0/781, Loss 0.040115758776664734 (0.040115758776664734)
 17%|████████████████████▎                                                                                                  | 4005/23430 [04:36<18:22, 17.62it/s]10/22/2025 09:08:23 - INFO - __main__ - Epoch 6/30, Step 100/781, Loss 0.0461195707321167 (0.03765942967764222)
 18%|████████████████████▊                                                                                                  | 4105/23430 [04:41<17:54, 17.98it/s]10/22/2025 09:08:29 - INFO - __main__ - Epoch 6/30, Step 200/781, Loss 0.05354709550738335 (0.038012540477573575)
 18%|█████████████████████▎                                                                                                 | 4205/23430 [04:47<17:48, 17.99it/s]10/22/2025 09:08:34 - INFO - __main__ - Epoch 6/30, Step 300/781, Loss 0.03467315435409546 (0.03861117219410069)
 18%|█████████████████████▊                                                                                                 | 4305/23430 [04:52<17:45, 17.94it/s]10/22/2025 09:08:40 - INFO - __main__ - Epoch 6/30, Step 400/781, Loss 0.030639763921499252 (0.0382095218782413)
 19%|██████████████████████▎                                                                                                | 4405/23430 [04:58<17:40, 17.95it/s]10/22/2025 09:08:45 - INFO - __main__ - Epoch 6/30, Step 500/781, Loss 0.038200218230485916 (0.038100286295819664)
 19%|██████████████████████▉                                                                                                | 4505/23430 [05:03<17:34, 17.94it/s]10/22/2025 09:08:51 - INFO - __main__ - Epoch 6/30, Step 600/781, Loss 0.04320710897445679 (0.03797965945238976)
 20%|███████████████████████▍                                                                                               | 4605/23430 [05:09<17:37, 17.81it/s]10/22/2025 09:08:57 - INFO - __main__ - Epoch 6/30, Step 700/781, Loss 0.05437614768743515 (0.037852346772240336)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 999/999 [00:09<00:00, 109.69it/s]
10/22/2025 09:09:10 - INFO - __main__ - Epoch 7/30███████████████████████████████████████████████████████████████████████████▊| 997/999 [00:09<00:00, 109.81it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-3-ddpm/checkpoints/checkpoint_epoch_5.pth
 20%|███████████████████████▍                                                                                             | 4687/23430 [05:23<7:44:49,  1.49s/it]10/22/2025 09:09:11 - INFO - __main__ - Epoch 7/30, Step 0/781, Loss 0.024934446439146996 (0.024934446439146996)
 20%|████████████████████████▎                                                                                              | 4787/23430 [05:29<17:41, 17.56it/s]10/22/2025 09:09:16 - INFO - __main__ - Epoch 7/30, Step 100/781, Loss 0.03394896537065506 (0.03839896445964823)
 21%|████████████████████████▊                                                                                              | 4887/23430 [05:35<17:28, 17.69it/s]10/22/2025 09:09:22 - INFO - __main__ - Epoch 7/30, Step 200/781, Loss 0.03748311102390289 (0.03745773440199112)
 21%|█████████████████████████▎                                                                                             | 4987/23430 [05:40<17:23, 17.68it/s]10/22/2025 09:09:28 - INFO - __main__ - Epoch 7/30, Step 300/781, Loss 0.035535141825675964 (0.037551977185909934)
 21%|█████████████████████████▌                                                                                             | 5037/23430 [05:43<17:25, 17.59it/s]
