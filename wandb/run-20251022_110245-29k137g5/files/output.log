10/22/2025 11:02:46 - INFO - __main__ - ***** Training arguments *****
10/22/2025 11:02:46 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', data_dir='/ocean/projects/cis250019p/jye9/11685-project/data', is_cifar_10=1, image_size=32, batch_size=64, num_workers=4, num_classes=10, run_name='exp-4-ddpm', output_dir='/ocean/projects/cis250019p/jye9/11685-project/experiments', num_epochs=30, learning_rate=0.0001, weight_decay=0, grad_clip=1.0, seed=42, mixed_precision='none', use_val=1, num_train_timesteps=2000, num_inference_steps=100, beta_start=0.0001, beta_end=0.02, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, optimizer_type='AdamW', scheduler_type='ConsineAnnealingLR', unet_in_size=32, unet_in_ch=3, unet_ch=128, unet_ch_mult=[1, 2, 2, 2], unet_attn=[1, 2, 3], unet_num_res_blocks=2, unet_dropout=0.2, latent_ddpm=False, pretrained_vae='/ocean/projects/cis250019p/jye9/11685-project/pretrained/model.ckpt', use_cfg=False, cfg_guidance_scale=2.0, use_ddim=False, ckpt=None, device='cuda', rank=0, world_size=1, predictor_type='epsilon', distributed=False, local_rank=0, total_batch_size=64, max_train_steps=23430)
10/22/2025 11:02:46 - INFO - __main__ - ***** Running training *****
10/22/2025 11:02:46 - INFO - __main__ -   Num examples = 50000
10/22/2025 11:02:46 - INFO - __main__ -   Num Epochs = 30
10/22/2025 11:02:46 - INFO - __main__ -   Instantaneous batch size per device = 64
10/22/2025 11:02:46 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 64
10/22/2025 11:02:46 - INFO - __main__ -   Total optimization steps per epoch 781
10/22/2025 11:02:46 - INFO - __main__ -   Total optimization steps = 23430
  0%|                                                                                                                                  | 0/23430 [00:00<?, ?it/s]10/22/2025 11:02:46 - INFO - __main__ - Epoch 1/30
  3%|███▉                                                                                                                  | 781/23430 [02:26<1:10:43,  5.34it/s]10/22/2025 11:05:13 - INFO - __main__ - Epoch 1/30, Step 780/781, Loss 0.03463740646839142 (0.23655393184490606)
10/22/2025 11:05:18 - INFO - __main__ - Epoch 1/30 Validation Loss: 0.031160
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.78it/s]
10/22/2025 11:05:32 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.2<00:00, 64.02it/s]
10/22/2025 11:05:32 - INFO - numexpr.utils - NumExpr defaulting to 16 threads.
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_0.pth
10/22/2025 11:05:38 - INFO - __main__ - Epoch 2/30
  7%|███████▊                                                                                                             | 1562/23430 [05:18<1:08:27,  5.32it/s]10/22/2025 11:08:04 - INFO - __main__ - Epoch 2/30, Step 780/781, Loss 0.02295970730483532 (0.030185478836030875)
10/22/2025 11:08:10 - INFO - __main__ - Epoch 2/30 Validation Loss: 0.025922
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 64.01it/s]
10/22/2025 11:08:12 - INFO - __main__ - Epoch 3/30███████████████████████████████████████████████████████████████████████████▌  | 98/100 [00:01<00:00, 65.39it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_1.pth
 10%|███████████▋                                                                                                         | 2343/23430 [07:52<1:06:08,  5.31it/s]10/22/2025 11:10:39 - INFO - __main__ - Epoch 3/30, Step 780/781, Loss 0.025156226009130478 (0.02675504197227016)
10/22/2025 11:10:45 - INFO - __main__ - Epoch 3/30 Validation Loss: 0.024825
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 62.93it/s]
10/22/2025 11:10:47 - INFO - __main__ - Epoch 4/30███████████████████████████████████████████████████████████████████████████▌  | 98/100 [00:01<00:00, 63.07it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_2.pth
 13%|███████████████▌                                                                                                     | 3124/23430 [10:27<1:03:37,  5.32it/s]10/22/2025 11:13:14 - INFO - __main__ - Epoch 4/30, Step 780/781, Loss 0.030264563858509064 (0.02578842220589442)
10/22/2025 11:13:19 - INFO - __main__ - Epoch 4/30 Validation Loss: 0.025448
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 65.86it/s]
10/22/2025 11:13:22 - INFO - __main__ - Epoch 5/30███████████████████████████████████████████████████████████████████████████▌  | 98/100 [00:01<00:00, 66.17it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_3.pth
 17%|███████████████████▌                                                                                                 | 3905/23430 [13:02<1:01:16,  5.31it/s]10/22/2025 11:15:49 - INFO - __main__ - Epoch 5/30, Step 780/781, Loss 0.03192926198244095 (0.024939930662703575)
10/22/2025 11:15:54 - INFO - __main__ - Epoch 5/30 Validation Loss: 0.023922
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 63.24it/s]
10/22/2025 11:15:56 - INFO - __main__ - Epoch 6/30███████████████████████████████████████████████████████████████████████████▌  | 98/100 [00:01<00:00, 63.14it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_4.pth
 20%|███████████████████████▊                                                                                               | 4686/23430 [15:37<58:39,  5.33it/s]10/22/2025 11:18:23 - INFO - __main__ - Epoch 6/30, Step 780/781, Loss 0.017993487417697906 (0.024423336675784117)
10/22/2025 11:18:29 - INFO - __main__ - Epoch 6/30 Validation Loss: 0.023970
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 67.93it/s]
10/22/2025 11:18:31 - INFO - __main__ - Epoch 7/30███████████████████████████████████████████████████████████████████████████▌  | 98/100 [00:01<00:00, 67.97it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_5.pth
 23%|███████████████████████████▊                                                                                           | 5467/23430 [18:11<56:19,  5.32it/s]10/22/2025 11:20:58 - INFO - __main__ - Epoch 7/30, Step 780/781, Loss 0.019312430173158646 (0.023338156904925075)
10/22/2025 11:21:04 - INFO - __main__ - Epoch 7/30 Validation Loss: 0.024499
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 63.73it/s]
10/22/2025 11:21:06 - INFO - __main__ - Epoch 8/30███████████████████████████████████████████████████████████████████████████▌  | 98/100 [00:01<00:00, 63.79it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_6.pth
 24%|████████████████████████████                                                                                           | 5532/23430 [18:32<56:05,  5.32it/s]
