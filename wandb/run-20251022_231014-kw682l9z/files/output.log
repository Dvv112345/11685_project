10/22/2025 23:10:16 - INFO - __main__ - ***** Training arguments *****
10/22/2025 23:10:16 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', data_dir='/ocean/projects/cis250019p/jye9/11685-project/data', is_cifar_10=True, image_size=32, batch_size=64, num_workers=4, num_classes=10, run_name='exp-0-ddpm', output_dir='/ocean/projects/cis250019p/jye9/11685-project/experiments', num_epochs=300, learning_rate=0.0001, weight_decay=0.02, grad_clip=1.0, seed=42, mixed_precision='none', use_val=True, num_train_timesteps=500, num_inference_steps=500, beta_start=0.0001, beta_end=0.01, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, optimizer_type='AdamW', scheduler_type='ConsineAnnealingLR', unet_in_size=32, unet_in_ch=3, unet_ch=64, unet_ch_mult=[1, 2, 2, 4], unet_attn=[2, 3], unet_num_res_blocks=2, unet_dropout=0.2, latent_ddpm=False, pretrained_vae='/ocean/projects/cis250019p/jye9/11685-project/pretrained/model.ckpt', use_cfg=False, cfg_guidance_scale=2, use_ddim=False, ckpt=None, device='cuda', rank=0, world_size=1, predictor_type='epsilon', distributed=False, local_rank=0, total_batch_size=64, max_train_steps=234300)
10/22/2025 23:10:16 - INFO - __main__ - ***** Running training *****
10/22/2025 23:10:16 - INFO - __main__ -   Num examples = 50000
10/22/2025 23:10:16 - INFO - __main__ -   Num Epochs = 300
10/22/2025 23:10:16 - INFO - __main__ -   Instantaneous batch size per device = 64
10/22/2025 23:10:16 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 64
10/22/2025 23:10:16 - INFO - __main__ -   Total optimization steps per epoch 781
10/22/2025 23:10:16 - INFO - __main__ -   Total optimization steps = 234300
  0%|                                                                                                                                 | 0/234300 [00:00<?, ?it/s]10/22/2025 23:10:16 - INFO - __main__ - Epoch 1/300
  0%|                                                                                                                    | 1/234300 [01:09<4518:15:40, 69.42s/it]10/22/2025 23:11:25 - INFO - __main__ - Epoch 1/300, Step 780/781, Loss 0.051755838096141815 (0.2543481316908755)
10/22/2025 23:11:28 - INFO - __main__ - Epoch 1/300 Validation Loss: 0.073668
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 79.58it/s]
10/22/2025 23:11:36 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.6<00:00, 84.65it/s]
10/22/2025 23:11:36 - INFO - numexpr.utils - NumExpr defaulting to 16 threads.
10/22/2025 23:11:37 - INFO - __main__ - Epoch 2/300
  0%|                                                                                                                    | 2/234300 [02:28<4898:14:40, 75.26s/it]10/22/2025 23:12:45 - INFO - __main__ - Epoch 2/300, Step 780/781, Loss 0.07111024111509323 (0.07359674313939182)
10/22/2025 23:12:48 - INFO - __main__ - Epoch 2/300 Validation Loss: 0.068778
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 79.56it/s]
10/22/2025 23:12:54 - INFO - __main__ - Epoch 3/300███████████████████████████████████████████████████████████████████████████▎| 496/499 [00:06<00:00, 81.03it/s]
  0%|                                                                                                                    | 3/234300 [03:42<4851:53:15, 74.55s/it]10/22/2025 23:13:59 - INFO - __main__ - Epoch 3/300, Step 780/781, Loss 0.06729982793331146 (0.06963118357004337)
10/22/2025 23:14:01 - INFO - __main__ - Epoch 3/300 Validation Loss: 0.064402
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 80.09it/s]
10/22/2025 23:14:07 - INFO - __main__ - Epoch 4/300██████████████████████████████████████████████████████████████████████████▊ | 494/499 [00:06<00:00, 74.02it/s]
  0%|                                                                                                                    | 4/234300 [04:55<4819:40:26, 74.06s/it]10/22/2025 23:15:12 - INFO - __main__ - Epoch 4/300, Step 780/781, Loss 0.06771448254585266 (0.06691386171458015)
10/22/2025 23:15:14 - INFO - __main__ - Epoch 4/300 Validation Loss: 0.064025
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 81.41it/s]
10/22/2025 23:15:20 - INFO - __main__ - Epoch 5/300██████████████████████████████████████████████████████████████████████████▊ | 494/499 [00:06<00:00, 81.08it/s]
  0%|                                                                                                                    | 5/234300 [06:08<4795:26:23, 73.68s/it]10/22/2025 23:16:25 - INFO - __main__ - Epoch 5/300, Step 780/781, Loss 0.05820305645465851 (0.0659828140148738)
10/22/2025 23:16:27 - INFO - __main__ - Epoch 5/300 Validation Loss: 0.062397
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 82.01it/s]
10/22/2025 23:16:33 - INFO - __main__ - Epoch 6/300██████████████████████████████████████████████████████████████████████████▊ | 494/499 [00:06<00:00, 82.10it/s]
  0%|                                                                                                                    | 6/234300 [07:21<4780:04:33, 73.45s/it]10/22/2025 23:17:38 - INFO - __main__ - Epoch 6/300, Step 780/781, Loss 0.04279675334692001 (0.06468047409601003)
10/22/2025 23:17:40 - INFO - __main__ - Epoch 6/300 Validation Loss: 0.063089
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 82.47it/s]
10/22/2025 23:17:46 - INFO - __main__ - Epoch 7/300███████████████████████████████████████████████████████████████████████████ | 495/499 [00:06<00:00, 82.66it/s]
  0%|                                                                                                                    | 7/234300 [08:34<4774:00:40, 73.35s/it]10/22/2025 23:18:51 - INFO - __main__ - Epoch 7/300, Step 780/781, Loss 0.07725849747657776 (0.06405943790486467)
10/22/2025 23:18:53 - INFO - __main__ - Epoch 7/300 Validation Loss: 0.058661
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 79.11it/s]
10/22/2025 23:19:00 - INFO - __main__ - Epoch 8/300██████████████████████████████████████████████████████████████████████████▎ | 492/499 [00:06<00:00, 78.84it/s]
  0%|                                                                                                                    | 8/234300 [09:49<4794:13:47, 73.67s/it]10/22/2025 23:20:05 - INFO - __main__ - Epoch 8/300, Step 780/781, Loss 0.06627892702817917 (0.06374240341797834)
10/22/2025 23:20:08 - INFO - __main__ - Epoch 8/300 Validation Loss: 0.063152
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 73.80it/s]
10/22/2025 23:20:14 - INFO - __main__ - Epoch 9/300███████████████████████████████████████████████████████████████████████████▎| 496/499 [00:06<00:00, 73.89it/s]
  0%|                                                                                                                    | 9/234300 [11:04<4820:49:18, 74.07s/it]10/22/2025 23:21:20 - INFO - __main__ - Epoch 9/300, Step 780/781, Loss 0.07222095131874084 (0.06327472855164055)
10/22/2025 23:21:23 - INFO - __main__ - Epoch 9/300 Validation Loss: 0.061163
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 82.58it/s]
10/22/2025 23:21:29 - INFO - __main__ - Epoch 10/300██████████████████████████████████████████████████████████████████████████ | 495/499 [00:05<00:00, 82.67it/s]
  0%|                                                                                                                   | 10/234300 [12:17<4801:21:53, 73.78s/it]10/22/2025 23:22:33 - INFO - __main__ - Epoch 10/300, Step 780/781, Loss 0.060820531100034714 (0.06308996739407355)
10/22/2025 23:22:36 - INFO - __main__ - Epoch 10/300 Validation Loss: 0.061944
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 82.60it/s]
10/22/2025 23:22:42 - INFO - __main__ - Epoch 11/300██████████████████████████████████████████████████████████████████████████ | 495/499 [00:05<00:00, 82.54it/s]
  0%|                                                                                                                   | 11/234300 [13:30<4781:53:08, 73.48s/it]10/22/2025 23:23:46 - INFO - __main__ - Epoch 11/300, Step 780/781, Loss 0.07568530738353729 (0.06266335648378397)
10/22/2025 23:23:48 - INFO - __main__ - Epoch 11/300 Validation Loss: 0.060941
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 80.92it/s]
10/22/2025 23:23:55 - INFO - __main__ - Epoch 12/300█████████████████████████████████████████████████████████████████████████▊ | 494/499 [00:06<00:00, 80.88it/s]
  0%|                                                                                                                   | 12/234300 [14:43<4788:42:07, 73.58s/it]10/22/2025 23:25:00 - INFO - __main__ - Epoch 12/300, Step 780/781, Loss 0.07523517310619354 (0.06150880642473774)
10/22/2025 23:25:02 - INFO - __main__ - Epoch 12/300 Validation Loss: 0.060330
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:05<00:00, 85.78it/s]
10/22/2025 23:25:08 - INFO - __main__ - Epoch 13/300██████████████████████████████████████████████████████████████████████████ | 495/499 [00:05<00:00, 86.15it/s]
  0%|                                                                                                                   | 13/234300 [15:57<4777:57:48, 73.42s/it]10/22/2025 23:26:13 - INFO - __main__ - Epoch 13/300, Step 780/781, Loss 0.05605819821357727 (0.06239970981903021)
10/22/2025 23:26:15 - INFO - __main__ - Epoch 13/300 Validation Loss: 0.061429
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 73.49it/s]
10/22/2025 23:26:22 - INFO - __main__ - Epoch 14/300██████████████████████████████████████████████████████████████████████████▎| 496/499 [00:06<00:00, 72.24it/s]
  0%|                                                                                                                   | 14/234300 [17:10<4782:00:39, 73.48s/it]10/22/2025 23:27:27 - INFO - __main__ - Epoch 14/300, Step 780/781, Loss 0.05839028209447861 (0.0617561064107241)
10/22/2025 23:27:29 - INFO - __main__ - Epoch 14/300 Validation Loss: 0.060146
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 75.64it/s]
10/22/2025 23:27:36 - INFO - __main__ - Epoch 15/300██████████████████████████████████████████████████████████████████████████▎| 496/499 [00:06<00:00, 75.69it/s]
  0%|                                                                                                                   | 15/234300 [18:25<4817:49:41, 74.03s/it]10/22/2025 23:28:42 - INFO - __main__ - Epoch 15/300, Step 780/781, Loss 0.08445769548416138 (0.060882125235855504)
10/22/2025 23:28:44 - INFO - __main__ - Epoch 15/300 Validation Loss: 0.060872
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:06<00:00, 73.97it/s]
10/22/2025 23:28:51 - INFO - __main__ - Epoch 16/300██████████████████████████████████████████████████████████████████████████▎| 496/499 [00:06<00:00, 74.61it/s]
  0%|                                                                                                                   | 16/234300 [19:41<4848:08:17, 74.50s/it]10/22/2025 23:29:58 - INFO - __main__ - Epoch 16/300, Step 780/781, Loss 0.08158568292856216 (0.061167842342438376)
10/22/2025 23:30:00 - INFO - __main__ - Epoch 16/300 Validation Loss: 0.058767
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 68.25it/s]
10/22/2025 23:30:07 - INFO - __main__ - Epoch 17/300█████████████████████████████████████████████████████████████████████████▌ | 493/499 [00:07<00:00, 67.94it/s]
  0%|                                                                                                                   | 17/234300 [20:58<4895:44:56, 75.23s/it]10/22/2025 23:31:15 - INFO - __main__ - Epoch 17/300, Step 780/781, Loss 0.041627757251262665 (0.06000502268269792)
10/22/2025 23:31:17 - INFO - __main__ - Epoch 17/300 Validation Loss: 0.059076
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 67.29it/s]
10/22/2025 23:31:24 - INFO - __main__ - Epoch 18/300██████████████████████████████████████████████████████████████████████████▌| 497/499 [00:07<00:00, 68.10it/s]
  0%|                                                                                                                   | 18/234300 [22:15<4932:17:08, 75.79s/it]10/22/2025 23:32:32 - INFO - __main__ - Epoch 18/300, Step 780/781, Loss 0.05490103363990784 (0.0603986094144105)
10/22/2025 23:32:34 - INFO - __main__ - Epoch 18/300 Validation Loss: 0.059226
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 68.90it/s]
10/22/2025 23:32:41 - INFO - __main__ - Epoch 19/300███████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 69.08it/s]
  0%|                                                                                                                   | 19/234300 [23:32<4954:44:32, 76.14s/it]10/22/2025 23:33:49 - INFO - __main__ - Epoch 19/300, Step 780/781, Loss 0.05737847834825516 (0.060628054384499905)
10/22/2025 23:33:51 - INFO - __main__ - Epoch 19/300 Validation Loss: 0.057348
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 69.71it/s]
10/22/2025 23:33:58 - INFO - __main__ - Epoch 20/300██████████████████████████████████████████████████████████████████████████▌| 497/499 [00:07<00:00, 69.57it/s]
  0%|                                                                                                                   | 20/234300 [24:49<4964:23:46, 76.28s/it]10/22/2025 23:35:05 - INFO - __main__ - Epoch 20/300, Step 780/781, Loss 0.044111233204603195 (0.06047187927781238)
10/22/2025 23:35:08 - INFO - __main__ - Epoch 20/300 Validation Loss: 0.062127
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 68.18it/s]
10/22/2025 23:35:15 - INFO - __main__ - Epoch 21/300█████████████████████████████████████████████████████████████████████████▌ | 493/499 [00:07<00:00, 68.05it/s]
  0%|                                                                                                                   | 21/234300 [26:06<4979:27:38, 76.52s/it]10/22/2025 23:36:22 - INFO - __main__ - Epoch 21/300, Step 780/781, Loss 0.04814670607447624 (0.05902724307645756)
10/22/2025 23:36:25 - INFO - __main__ - Epoch 21/300 Validation Loss: 0.057831
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 68.43it/s]
10/22/2025 23:36:32 - INFO - __main__ - Epoch 22/300██████████████████████████████████████████████████████████████████████████▊| 498/499 [00:07<00:00, 68.28it/s]
  0%|                                                                                                                   | 22/234300 [27:23<4988:26:31, 76.65s/it]10/22/2025 23:37:39 - INFO - __main__ - Epoch 22/300, Step 780/781, Loss 0.05846722051501274 (0.05990188237322583)
10/22/2025 23:37:42 - INFO - __main__ - Epoch 22/300 Validation Loss: 0.059664
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 66.45it/s]
10/22/2025 23:37:49 - INFO - __main__ - Epoch 23/300███████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 66.63it/s]
  0%|                                                                                                                   | 23/234300 [28:40<5001:25:41, 76.85s/it]10/22/2025 23:38:57 - INFO - __main__ - Epoch 23/300, Step 780/781, Loss 0.06693502515554428 (0.06050186560855327)
10/22/2025 23:38:59 - INFO - __main__ - Epoch 23/300 Validation Loss: 0.059845
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 67.81it/s]
10/22/2025 23:39:06 - INFO - __main__ - Epoch 24/300██████████████████████████████████████████████████████████████████████████▌| 497/499 [00:07<00:00, 67.29it/s]
  0%|                                                                                                                   | 24/234300 [29:57<5007:05:16, 76.94s/it]10/22/2025 23:40:14 - INFO - __main__ - Epoch 24/300, Step 780/781, Loss 0.06124455854296684 (0.05918215366888901)
10/22/2025 23:40:16 - INFO - __main__ - Epoch 24/300 Validation Loss: 0.058617
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 66.44it/s]
10/22/2025 23:40:24 - INFO - __main__ - Epoch 25/300██████████████████████████████████████████████████████████████████████████▌| 497/499 [00:07<00:00, 66.45it/s]
  0%|                                                                                                                   | 25/234300 [31:14<5009:42:49, 76.98s/it]10/22/2025 23:41:31 - INFO - __main__ - Epoch 25/300, Step 780/781, Loss 0.044484943151474 (0.05939347074675957)
10/22/2025 23:41:33 - INFO - __main__ - Epoch 25/300 Validation Loss: 0.057996
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 67.54it/s]
10/22/2025 23:41:41 - INFO - __main__ - Epoch 26/300██████████████████████████████████████████████████████████████████████████▌| 497/499 [00:07<00:00, 67.48it/s]
  0%|                                                                                                                   | 26/234300 [32:31<5012:07:09, 77.02s/it]10/22/2025 23:42:48 - INFO - __main__ - Epoch 26/300, Step 780/781, Loss 0.060406964272260666 (0.058638741117967685)
10/22/2025 23:42:50 - INFO - __main__ - Epoch 26/300 Validation Loss: 0.056191
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 67.81it/s]
10/22/2025 23:42:58 - INFO - __main__ - Epoch 27/300██████████████████████████████████████████████████████████████████████████▌| 497/499 [00:07<00:00, 69.05it/s]
  0%|                                                                                                                   | 27/234300 [33:48<5015:14:40, 77.07s/it]10/22/2025 23:44:05 - INFO - __main__ - Epoch 27/300, Step 780/781, Loss 0.059845905750989914 (0.059864232443015496)
10/22/2025 23:44:07 - INFO - __main__ - Epoch 27/300 Validation Loss: 0.058989
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 68.00it/s]
10/22/2025 23:44:15 - INFO - __main__ - Epoch 28/300██████████████████████████████████████████████████████████████████████████▌| 497/499 [00:07<00:00, 67.99it/s]
  0%|                                                                                                                   | 28/234300 [35:06<5015:25:49, 77.07s/it]10/22/2025 23:45:22 - INFO - __main__ - Epoch 28/300, Step 780/781, Loss 0.06156180053949356 (0.05927677615694749)
10/22/2025 23:45:25 - INFO - __main__ - Epoch 28/300 Validation Loss: 0.057112
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 68.68it/s]
10/22/2025 23:45:32 - INFO - __main__ - Epoch 29/300█████████████████████████████████████████████████████████████████████████▌ | 493/499 [00:07<00:00, 68.44it/s]
  0%|                                                                                                                   | 29/234300 [36:23<5014:15:39, 77.05s/it]10/22/2025 23:46:39 - INFO - __main__ - Epoch 29/300, Step 780/781, Loss 0.06346151232719421 (0.058883446885246625)
10/22/2025 23:46:42 - INFO - __main__ - Epoch 29/300 Validation Loss: 0.057440
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 68.09it/s]
10/22/2025 23:46:49 - INFO - __main__ - Epoch 30/300██████████████████████████████████████████████████████████████████████████▊| 498/499 [00:07<00:00, 67.97it/s]
  0%|                                                                                                                   | 30/234300 [37:39<5010:16:10, 76.99s/it]10/22/2025 23:47:56 - INFO - __main__ - Epoch 30/300, Step 780/781, Loss 0.0714893713593483 (0.05874279892685014)
10/22/2025 23:47:58 - INFO - __main__ - Epoch 30/300 Validation Loss: 0.058728
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 69.41it/s]
10/22/2025 23:48:06 - INFO - __main__ - Epoch 31/300██████████████████████████████████████████████████████████████████████████▊| 498/499 [00:07<00:00, 69.36it/s]
  0%|                                                                                                                   | 31/234300 [38:56<5000:48:36, 76.85s/it]10/22/2025 23:49:12 - INFO - __main__ - Epoch 31/300, Step 780/781, Loss 0.072441965341568 (0.05853900719057201)
10/22/2025 23:49:15 - INFO - __main__ - Epoch 31/300 Validation Loss: 0.057161
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:07<00:00, 68.04it/s]
10/22/2025 23:49:22 - INFO - __main__ - Epoch 32/300██████████████████████████████████████████████████████████████████████████▊| 498/499 [00:07<00:00, 68.27it/s]
