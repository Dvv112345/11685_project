10/20/2025 23:37:17 - INFO - __main__ - ***** Training arguments *****
10/20/2025 23:37:17 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', data_dir='/ocean/projects/cis250019p/jye9/11685-project/data', image_size=32, batch_size=64, num_workers=4, num_classes=10, run_name='exp-4-ddpm', output_dir='/ocean/projects/cis250019p/jye9/11685-project/experiments', num_epochs=10, learning_rate=0.0001, weight_decay=0.01, grad_clip=1.0, seed=42, mixed_precision='none', num_train_timesteps=100, num_inference_steps=100, beta_start=0.0005, beta_end=0.02, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, optimizer_type='AdamW', scheduler_type='ConsineAnnealingLR', unet_in_size=32, unet_in_ch=3, unet_ch=64, unet_ch_mult=[1, 2, 2, 4], unet_attn=[2, 3], unet_num_res_blocks=1, unet_dropout=0.0, latent_ddpm=False, pretrained_vae='pretrained/model.ckpt', use_cfg=False, cfg_guidance_scale=2.0, use_ddim=False, ckpt=None, predictor_type='epsilon', distributed=False, world_size=1, rank=0, local_rank=0, device='cuda', total_batch_size=64, max_train_steps=7810)
10/20/2025 23:37:17 - INFO - __main__ - ***** Running training *****
10/20/2025 23:37:17 - INFO - __main__ -   Num examples = 50000
10/20/2025 23:37:17 - INFO - __main__ -   Num Epochs = 10
10/20/2025 23:37:17 - INFO - __main__ -   Instantaneous batch size per device = 64
10/20/2025 23:37:17 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 64
10/20/2025 23:37:17 - INFO - __main__ -   Total optimization steps per epoch 781
10/20/2025 23:37:17 - INFO - __main__ -   Total optimization steps = 7810
  0%|                                                                                      | 0/7810 [00:00<?, ?it/s]10/20/2025 23:37:17 - INFO - __main__ - Epoch 1/10
  0%|                                                                            | 1/7810 [00:01<3:01:37,  1.40s/it]10/20/2025 23:37:19 - INFO - __main__ - Epoch 1/10, Step 0/781, Loss 0.9998959898948669 (0.9998959898948669)
  1%|▉                                                                           | 101/7810 [00:06<07:02, 18.25it/s]10/20/2025 23:37:24 - INFO - __main__ - Epoch 1/10, Step 100/781, Loss 0.8317591547966003 (0.9296991040210912)
  3%|█▉                                                                          | 201/7810 [00:12<06:55, 18.31it/s]10/20/2025 23:37:30 - INFO - __main__ - Epoch 1/10, Step 200/781, Loss 0.63035649061203 (0.827386931993475)
  4%|██▉                                                                         | 301/7810 [00:17<06:52, 18.20it/s]10/20/2025 23:37:35 - INFO - __main__ - Epoch 1/10, Step 300/781, Loss 0.4564840495586395 (0.7321579135533584)
  5%|███▉                                                                        | 401/7810 [00:23<06:48, 18.15it/s]10/20/2025 23:37:41 - INFO - __main__ - Epoch 1/10, Step 400/781, Loss 0.32378631830215454 (0.646860346681162)
  6%|████▉                                                                       | 501/7810 [00:28<06:42, 18.17it/s]10/20/2025 23:37:46 - INFO - __main__ - Epoch 1/10, Step 500/781, Loss 0.23842327296733856 (0.5736532043256684)
  8%|█████▊                                                                      | 601/7810 [00:34<06:40, 18.01it/s]10/20/2025 23:37:52 - INFO - __main__ - Epoch 1/10, Step 600/781, Loss 0.17630009353160858 (0.5118513264989297)
  9%|██████▊                                                                     | 701/7810 [00:40<06:36, 17.93it/s]10/20/2025 23:37:57 - INFO - __main__ - Epoch 1/10, Step 700/781, Loss 0.15457592904567719 (0.46085168110916175)
100%|███████████████████████████████████████████████████████████████████████████████| 99/99 [00:01<00:00, 76.03it/s]
10/20/2025 23:38:03 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
10/20/2025 23:38:03 - INFO - numexpr.utils - NumExpr defaulting to 16 threads.
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_0.pth
10/20/2025 23:38:04 - INFO - __main__ - Epoch 2/10
10/20/2025 23:38:05 - INFO - __main__ - Epoch 2/10, Step 0/781, Loss 0.11007463932037354 (0.11007463932037354)
 11%|████████▌                                                                   | 881/7810 [00:52<06:22, 18.11it/s]10/20/2025 23:38:10 - INFO - __main__ - Epoch 2/10, Step 100/781, Loss 0.10808968544006348 (0.1207603858691631)
 13%|█████████▌                                                                  | 981/7810 [00:58<06:16, 18.14it/s]10/20/2025 23:38:16 - INFO - __main__ - Epoch 2/10, Step 200/781, Loss 0.12069885432720184 (0.11663285135036677)
 14%|██████████▍                                                                | 1081/7810 [01:03<06:13, 18.02it/s]10/20/2025 23:38:21 - INFO - __main__ - Epoch 2/10, Step 300/781, Loss 0.11207474768161774 (0.1141121374362727)
 15%|███████████▎                                                               | 1181/7810 [01:09<06:08, 18.00it/s]10/20/2025 23:38:27 - INFO - __main__ - Epoch 2/10, Step 400/781, Loss 0.09948953241109848 (0.11245845836073978)
 16%|████████████▎                                                              | 1281/7810 [01:14<06:04, 17.90it/s]10/20/2025 23:38:32 - INFO - __main__ - Epoch 2/10, Step 500/781, Loss 0.10585713386535645 (0.11086690935962452)
 18%|█████████████▎                                                             | 1381/7810 [01:20<05:57, 17.99it/s]10/20/2025 23:38:38 - INFO - __main__ - Epoch 2/10, Step 600/781, Loss 0.11627297103404999 (0.10925872176389725)
 19%|██████████████▏                                                            | 1481/7810 [01:26<05:53, 17.91it/s]10/20/2025 23:38:44 - INFO - __main__ - Epoch 2/10, Step 700/781, Loss 0.0963018462061882 (0.10804842339135101)
100%|██████████████████████████████████████████████████████████████████████████████| 99/99 [00:00<00:00, 111.83it/s]
10/20/2025 23:38:49 - INFO - __main__ - Epoch 3/10████████████████████████████▎    | 93/99 [00:00<00:00, 113.59it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_1.pth
 20%|███████████████                                                            | 1563/7810 [01:32<26:12,  3.97it/s]10/20/2025 23:38:49 - INFO - __main__ - Epoch 3/10, Step 0/781, Loss 0.12247571349143982 (0.12247571349143982)
 21%|███████████████▉                                                           | 1663/7810 [01:37<05:40, 18.07it/s]10/20/2025 23:38:55 - INFO - __main__ - Epoch 3/10, Step 100/781, Loss 0.10236676782369614 (0.09837298427182849)
 23%|████████████████▉                                                          | 1763/7810 [01:43<05:34, 18.05it/s]10/20/2025 23:39:01 - INFO - __main__ - Epoch 3/10, Step 200/781, Loss 0.09488650411367416 (0.09876196887066115)
 24%|█████████████████▉                                                         | 1863/7810 [01:48<05:28, 18.11it/s]10/20/2025 23:39:06 - INFO - __main__ - Epoch 3/10, Step 300/781, Loss 0.09213386476039886 (0.09909310134938389)
 25%|██████████████████▊                                                        | 1963/7810 [01:54<05:23, 18.07it/s]10/20/2025 23:39:12 - INFO - __main__ - Epoch 3/10, Step 400/781, Loss 0.08411606401205063 (0.09867136364342863)
 26%|███████████████████▊                                                       | 2063/7810 [01:59<05:19, 17.98it/s]10/20/2025 23:39:17 - INFO - __main__ - Epoch 3/10, Step 500/781, Loss 0.0957295298576355 (0.09829065159052432)
 28%|████████████████████▊                                                      | 2163/7810 [02:05<05:15, 17.87it/s]10/20/2025 23:39:23 - INFO - __main__ - Epoch 3/10, Step 600/781, Loss 0.08512073010206223 (0.09800446127694776)
 29%|█████████████████████▋                                                     | 2263/7810 [02:10<05:09, 17.92it/s]10/20/2025 23:39:28 - INFO - __main__ - Epoch 3/10, Step 700/781, Loss 0.10916637629270554 (0.09807481125698621)
100%|██████████████████████████████████████████████████████████████████████████████| 99/99 [00:00<00:00, 116.54it/s]
10/20/2025 23:39:34 - INFO - __main__ - Epoch 4/10██████████████████████████████▋  | 96/99 [00:00<00:00, 116.72it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_2.pth
10/20/2025 23:39:34 - INFO - __main__ - Epoch 4/10, Step 0/781, Loss 0.14351320266723633 (0.14351320266723633)
 31%|███████████████████████▍                                                   | 2443/7810 [02:22<04:56, 18.11it/s]10/20/2025 23:39:40 - INFO - __main__ - Epoch 4/10, Step 100/781, Loss 0.11089324951171875 (0.09602093091695615)
 33%|████████████████████████▍                                                  | 2543/7810 [02:27<04:53, 17.92it/s]10/20/2025 23:39:45 - INFO - __main__ - Epoch 4/10, Step 200/781, Loss 0.08311352878808975 (0.09620131192664008)
 34%|█████████████████████████▍                                                 | 2643/7810 [02:33<04:48, 17.92it/s]10/20/2025 23:39:51 - INFO - __main__ - Epoch 4/10, Step 300/781, Loss 0.08502207696437836 (0.09601205867093267)
 35%|██████████████████████████▎                                                | 2743/7810 [02:38<04:41, 18.00it/s]10/20/2025 23:39:56 - INFO - __main__ - Epoch 4/10, Step 400/781, Loss 0.10229717195034027 (0.0958080780773686)
 36%|███████████████████████████▎                                               | 2843/7810 [02:44<04:36, 17.97it/s]10/20/2025 23:40:02 - INFO - __main__ - Epoch 4/10, Step 500/781, Loss 0.13467416167259216 (0.09532398284373883)
 38%|████████████████████████████▎                                              | 2943/7810 [02:50<04:32, 17.85it/s]10/20/2025 23:40:08 - INFO - __main__ - Epoch 4/10, Step 600/781, Loss 0.12855581939220428 (0.0952498602267113)
 39%|█████████████████████████████▏                                             | 3043/7810 [02:55<04:27, 17.80it/s]10/20/2025 23:40:13 - INFO - __main__ - Epoch 4/10, Step 700/781, Loss 0.08733464777469635 (0.09513131846885028)
100%|██████████████████████████████████████████████████████████████████████████████| 99/99 [00:00<00:00, 112.47it/s]
10/20/2025 23:40:19 - INFO - __main__ - Epoch 5/10██████████████████████████████▋  | 96/99 [00:00<00:00, 112.82it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_3.pth
 40%|██████████████████████████████                                             | 3125/7810 [03:01<20:10,  3.87it/s]10/20/2025 23:40:19 - INFO - __main__ - Epoch 5/10, Step 0/781, Loss 0.08211128413677216 (0.08211128413677216)
 41%|██████████████████████████████▉                                            | 3225/7810 [03:07<04:13, 18.10it/s]10/20/2025 23:40:25 - INFO - __main__ - Epoch 5/10, Step 100/781, Loss 0.08212406933307648 (0.09258811205330461)
 43%|███████████████████████████████▉                                           | 3325/7810 [03:12<04:09, 17.97it/s]10/20/2025 23:40:30 - INFO - __main__ - Epoch 5/10, Step 200/781, Loss 0.10065647959709167 (0.09419222683900624)
 44%|████████████████████████████████▉                                          | 3425/7810 [03:18<04:02, 18.10it/s]10/20/2025 23:40:36 - INFO - __main__ - Epoch 5/10, Step 300/781, Loss 0.10857032239437103 (0.09403016551883514)
 45%|█████████████████████████████████▊                                         | 3525/7810 [03:23<04:00, 17.80it/s]10/20/2025 23:40:41 - INFO - __main__ - Epoch 5/10, Step 400/781, Loss 0.08146797865629196 (0.09324796445797803)
 46%|██████████████████████████████████▊                                        | 3625/7810 [03:29<03:53, 17.95it/s]10/20/2025 23:40:47 - INFO - __main__ - Epoch 5/10, Step 500/781, Loss 0.07628636807203293 (0.0930470312962275)
 48%|███████████████████████████████████▊                                       | 3725/7810 [03:35<03:48, 17.88it/s]10/20/2025 23:40:52 - INFO - __main__ - Epoch 5/10, Step 600/781, Loss 0.0668579488992691 (0.09309994276867135)
 49%|████████████████████████████████████▋                                      | 3825/7810 [03:40<03:41, 18.01it/s]10/20/2025 23:40:58 - INFO - __main__ - Epoch 5/10, Step 700/781, Loss 0.10162203013896942 (0.0929525766452607)
100%|██████████████████████████████████████████████████████████████████████████████| 99/99 [00:00<00:00, 117.90it/s]
10/20/2025 23:41:04 - INFO - __main__ - Epoch 6/10███████████████████████████████▍ | 97/99 [00:00<00:00, 118.86it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_4.pth
10/20/2025 23:41:04 - INFO - __main__ - Epoch 6/10, Step 0/781, Loss 0.09238958358764648 (0.09238958358764648)
 51%|██████████████████████████████████████▍                                    | 4005/7810 [03:51<03:29, 18.14it/s]10/20/2025 23:41:09 - INFO - __main__ - Epoch 6/10, Step 100/781, Loss 0.07578875869512558 (0.09171146892084933)
 53%|███████████████████████████████████████▍                                   | 4105/7810 [03:57<03:25, 18.03it/s]10/20/2025 23:41:15 - INFO - __main__ - Epoch 6/10, Step 200/781, Loss 0.07777930796146393 (0.09255692759408286)
 54%|████████████████████████████████████████▍                                  | 4205/7810 [04:03<03:21, 17.85it/s]10/20/2025 23:41:21 - INFO - __main__ - Epoch 6/10, Step 300/781, Loss 0.08608584105968475 (0.09216493982017239)
 55%|█████████████████████████████████████████▎                                 | 4305/7810 [04:08<03:15, 17.97it/s]10/20/2025 23:41:26 - INFO - __main__ - Epoch 6/10, Step 400/781, Loss 0.08416672050952911 (0.0915911078564544)
 56%|██████████████████████████████████████████▎                                | 4405/7810 [04:14<03:10, 17.90it/s]10/20/2025 23:41:32 - INFO - __main__ - Epoch 6/10, Step 500/781, Loss 0.09639720618724823 (0.09175580107939696)
 58%|███████████████████████████████████████████▎                               | 4505/7810 [04:19<03:05, 17.78it/s]10/20/2025 23:41:37 - INFO - __main__ - Epoch 6/10, Step 600/781, Loss 0.08488185703754425 (0.09164383546286534)
 59%|████████████████████████████████████████████▏                              | 4605/7810 [04:25<02:56, 18.11it/s]10/20/2025 23:41:43 - INFO - __main__ - Epoch 6/10, Step 700/781, Loss 0.0969119668006897 (0.09162341680021667)
100%|██████████████████████████████████████████████████████████████████████████████| 99/99 [00:00<00:00, 115.61it/s]
10/20/2025 23:41:48 - INFO - __main__ - Epoch 7/10██████████████████████████████▋  | 96/99 [00:00<00:00, 115.46it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_5.pth
 60%|█████████████████████████████████████████████                              | 4687/7810 [04:31<12:58,  4.01it/s]10/20/2025 23:41:49 - INFO - __main__ - Epoch 7/10, Step 0/781, Loss 0.09067678451538086 (0.09067678451538086)
 61%|█████████████████████████████████████████████▉                             | 4787/7810 [04:36<02:47, 18.01it/s]10/20/2025 23:41:54 - INFO - __main__ - Epoch 7/10, Step 100/781, Loss 0.09833656251430511 (0.09033254991368492)
 63%|██████████████████████████████████████████████▉                            | 4887/7810 [04:42<02:41, 18.10it/s]10/20/2025 23:42:00 - INFO - __main__ - Epoch 7/10, Step 200/781, Loss 0.09413294494152069 (0.08986731937423867)
 64%|███████████████████████████████████████████████▉                           | 4987/7810 [04:47<02:37, 17.92it/s]10/20/2025 23:42:05 - INFO - __main__ - Epoch 7/10, Step 300/781, Loss 0.09947126358747482 (0.0902831407133923)
 65%|████████████████████████████████████████████████▊                          | 5087/7810 [04:53<02:31, 17.98it/s]10/20/2025 23:42:11 - INFO - __main__ - Epoch 7/10, Step 400/781, Loss 0.08731945604085922 (0.09044239047608173)
 66%|█████████████████████████████████████████████████▊                         | 5187/7810 [04:59<02:26, 17.94it/s]10/20/2025 23:42:16 - INFO - __main__ - Epoch 7/10, Step 500/781, Loss 0.09964394569396973 (0.09023005951069549)
 68%|██████████████████████████████████████████████████▊                        | 5287/7810 [05:04<02:20, 17.91it/s]10/20/2025 23:42:22 - INFO - __main__ - Epoch 7/10, Step 600/781, Loss 0.08448787778615952 (0.09013806535132514)
 69%|███████████████████████████████████████████████████▋                       | 5387/7810 [05:10<02:14, 18.06it/s]10/20/2025 23:42:28 - INFO - __main__ - Epoch 7/10, Step 700/781, Loss 0.08741237968206406 (0.08989442887047729)
100%|██████████████████████████████████████████████████████████████████████████████| 99/99 [00:00<00:00, 116.78it/s]
10/20/2025 23:42:33 - INFO - __main__ - Epoch 8/10██████████████████████████████▋  | 96/99 [00:00<00:00, 117.26it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_6.pth
10/20/2025 23:42:33 - INFO - __main__ - Epoch 8/10, Step 0/781, Loss 0.0863790512084961 (0.0863790512084961)
 71%|█████████████████████████████████████████████████████▍                     | 5567/7810 [05:21<02:05, 17.85it/s]10/20/2025 23:42:39 - INFO - __main__ - Epoch 8/10, Step 100/781, Loss 0.07496751099824905 (0.08994904551470634)
 73%|██████████████████████████████████████████████████████▍                    | 5667/7810 [05:27<01:58, 18.05it/s]10/20/2025 23:42:45 - INFO - __main__ - Epoch 8/10, Step 200/781, Loss 0.08124470710754395 (0.08995625065333808)
 74%|███████████████████████████████████████████████████████▍                   | 5767/7810 [05:32<01:53, 17.94it/s]10/20/2025 23:42:50 - INFO - __main__ - Epoch 8/10, Step 300/781, Loss 0.08110916614532471 (0.09009135908066632)
 75%|████████████████████████████████████████████████████████▎                  | 5867/7810 [05:38<01:48, 17.93it/s]10/20/2025 23:42:56 - INFO - __main__ - Epoch 8/10, Step 400/781, Loss 0.09456058591604233 (0.08942035711056871)
 76%|█████████████████████████████████████████████████████████▎                 | 5967/7810 [05:43<01:43, 17.85it/s]10/20/2025 23:43:01 - INFO - __main__ - Epoch 8/10, Step 500/781, Loss 0.08504758775234222 (0.08938878507700984)
 78%|██████████████████████████████████████████████████████████▎                | 6067/7810 [05:49<01:36, 18.15it/s]10/20/2025 23:43:07 - INFO - __main__ - Epoch 8/10, Step 600/781, Loss 0.07381963729858398 (0.08915708574796477)
 79%|███████████████████████████████████████████████████████████▏               | 6167/7810 [05:54<01:31, 17.97it/s]10/20/2025 23:43:12 - INFO - __main__ - Epoch 8/10, Step 700/781, Loss 0.09281514585018158 (0.08933495475077595)
100%|██████████████████████████████████████████████████████████████████████████████| 99/99 [00:00<00:00, 119.90it/s]
10/20/2025 23:43:18 - INFO - __main__ - Epoch 9/10█████████████████████████        | 89/99 [00:00<00:00, 119.75it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-4-ddpm/checkpoints/checkpoint_epoch_7.pth
 80%|████████████████████████████████████████████████████████████               | 6249/7810 [06:00<06:25,  4.05it/s]10/20/2025 23:43:18 - INFO - __main__ - Epoch 9/10, Step 0/781, Loss 0.08496087789535522 (0.08496087789535522)
 81%|████████████████████████████████████████████████████████████▉              | 6349/7810 [06:06<01:21, 17.88it/s]10/20/2025 23:43:24 - INFO - __main__ - Epoch 9/10, Step 100/781, Loss 0.07471896708011627 (0.08844284185826189)
 83%|█████████████████████████████████████████████████████████████▉             | 6449/7810 [06:11<01:15, 18.07it/s]10/20/2025 23:43:29 - INFO - __main__ - Epoch 9/10, Step 200/781, Loss 0.09711267054080963 (0.08893695831372964)
 84%|██████████████████████████████████████████████████████████████▉            | 6549/7810 [06:17<01:10, 17.90it/s]10/20/2025 23:43:35 - INFO - __main__ - Epoch 9/10, Step 300/781, Loss 0.08343523740768433 (0.08893621840399761)
 85%|███████████████████████████████████████████████████████████████▊           | 6649/7810 [06:23<01:04, 17.98it/s]10/20/2025 23:43:40 - INFO - __main__ - Epoch 9/10, Step 400/781, Loss 0.08508855104446411 (0.0887422500424403)
 86%|████████████████████████████████████████████████████████████████▊          | 6749/7810 [06:28<00:59, 17.91it/s]10/20/2025 23:43:46 - INFO - __main__ - Epoch 9/10, Step 500/781, Loss 0.07306122034788132 (0.08849171775870933)
 88%|█████████████████████████████████████████████████████████████████▊         | 6849/7810 [06:34<00:53, 18.08it/s]10/20/2025 23:43:52 - INFO - __main__ - Epoch 9/10, Step 600/781, Loss 0.08675919473171234 (0.088433744277365)
 89%|██████████████████████████████████████████████████████████████████▋        | 6949/7810 [06:39<00:47, 18.20it/s]10/20/2025 23:43:57 - INFO - __main__ - Epoch 9/10, Step 700/781, Loss 0.1024378165602684 (0.08837644974256038)
 90%|███████████████████████████████████████████████████████████████████▎       | 7003/7810 [06:42<00:44, 18.16it/s]
