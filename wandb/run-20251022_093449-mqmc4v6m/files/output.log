10/22/2025 09:34:50 - INFO - __main__ - ***** Training arguments *****
10/22/2025 09:34:50 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', data_dir='/ocean/projects/cis250019p/jye9/11685-project/data', image_size=32, batch_size=64, num_workers=4, num_classes=10, run_name='exp-0-ddpm', output_dir='/ocean/projects/cis250019p/jye9/11685-project/experiments', num_epochs=30, learning_rate=0.0001, weight_decay=0, grad_clip=1.0, seed=42, mixed_precision='none', num_train_timesteps=2000, num_inference_steps=100, beta_start=0.0001, beta_end=0.02, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, optimizer_type='AdamW', scheduler_type='ConsineAnnealingLR', unet_in_size=32, unet_in_ch=3, unet_ch=128, unet_ch_mult=[1, 2, 2, 2], unet_attn=[1, 2, 3], unet_num_res_blocks=1, unet_dropout=0.2, latent_ddpm=False, pretrained_vae='/ocean/projects/cis250019p/jye9/11685-project/pretrained/model.ckpt', use_cfg=False, cfg_guidance_scale=2.0, use_ddim=False, ckpt=None, device='cuda', rank=0, world_size=1, predictor_type='epsilon', distributed=False, local_rank=0, total_batch_size=64, max_train_steps=23430)
10/22/2025 09:34:50 - INFO - __main__ - ***** Running training *****
10/22/2025 09:34:50 - INFO - __main__ -   Num examples = 50000
10/22/2025 09:34:50 - INFO - __main__ -   Num Epochs = 30
10/22/2025 09:34:50 - INFO - __main__ -   Instantaneous batch size per device = 64
10/22/2025 09:34:50 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 64
10/22/2025 09:34:50 - INFO - __main__ -   Total optimization steps per epoch 781
10/22/2025 09:34:50 - INFO - __main__ -   Total optimization steps = 23430
  0%|                                                                                                                                  | 0/23430 [00:00<?, ?it/s]10/22/2025 09:34:50 - INFO - __main__ - Epoch 1/30
  0%|                                                                                                                        | 1/23430 [00:00<4:43:12,  1.38it/s]10/22/2025 09:34:51 - INFO - __main__ - Epoch 1/30, Step 0/781, Loss 0.999896228313446 (0.999896228313446)
  0%|▌                                                                                                                       | 101/23430 [00:12<47:55,  8.11it/s]10/22/2025 09:35:03 - INFO - __main__ - Epoch 1/30, Step 100/781, Loss 0.7138266563415527 (0.8721400688190272)
  1%|█                                                                                                                       | 201/23430 [00:25<47:47,  8.10it/s]10/22/2025 09:35:15 - INFO - __main__ - Epoch 1/30, Step 200/781, Loss 0.3365837037563324 (0.6963081825431899)
  1%|█▌                                                                                                                      | 301/23430 [00:37<47:34,  8.10it/s]10/22/2025 09:35:28 - INFO - __main__ - Epoch 1/30, Step 300/781, Loss 0.1563926339149475 (0.5489517075575864)
  2%|██                                                                                                                      | 401/23430 [00:50<47:21,  8.11it/s]10/22/2025 09:35:40 - INFO - __main__ - Epoch 1/30, Step 400/781, Loss 0.05551135540008545 (0.4364358924533661)
  2%|██▌                                                                                                                     | 501/23430 [01:02<47:08,  8.11it/s]10/22/2025 09:35:52 - INFO - __main__ - Epoch 1/30, Step 500/781, Loss 0.043777428567409515 (0.35901070965413084)
  3%|███                                                                                                                     | 601/23430 [01:14<46:54,  8.11it/s]10/22/2025 09:36:05 - INFO - __main__ - Epoch 1/30, Step 600/781, Loss 0.03363528102636337 (0.3056058295926516)
  3%|███▌                                                                                                                    | 701/23430 [01:27<46:43,  8.11it/s]10/22/2025 09:36:17 - INFO - __main__ - Epoch 1/30, Step 700/781, Loss 0.038664862513542175 (0.2670048575718142)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 96.73it/s]
10/22/2025 09:36:28 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.<00:00, 105.45it/s]
10/22/2025 09:36:28 - INFO - numexpr.utils - NumExpr defaulting to 16 threads.
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-0-ddpm/checkpoints/checkpoint_epoch_0.pth
10/22/2025 09:36:29 - INFO - __main__ - Epoch 2/30
  3%|███▉                                                                                                                  | 782/23430 [01:39<4:39:52,  1.35it/s]10/22/2025 09:36:29 - INFO - __main__ - Epoch 2/30, Step 0/781, Loss 0.030061203986406326 (0.030061203986406326)
  4%|████▌                                                                                                                   | 882/23430 [01:51<46:22,  8.10it/s]10/22/2025 09:36:42 - INFO - __main__ - Epoch 2/30, Step 100/781, Loss 0.020802943035960197 (0.03433963943199061)
  4%|█████                                                                                                                   | 982/23430 [02:03<46:10,  8.10it/s]10/22/2025 09:36:54 - INFO - __main__ - Epoch 2/30, Step 200/781, Loss 0.01492825523018837 (0.03324359406564218)
  5%|█████▍                                                                                                                 | 1082/23430 [02:16<45:56,  8.11it/s]10/22/2025 09:37:06 - INFO - __main__ - Epoch 2/30, Step 300/781, Loss 0.03338122367858887 (0.03270862443044633)
  5%|██████                                                                                                                 | 1182/23430 [02:28<45:47,  8.10it/s]10/22/2025 09:37:19 - INFO - __main__ - Epoch 2/30, Step 400/781, Loss 0.031460970640182495 (0.03217159299658347)
  5%|██████▌                                                                                                                | 1282/23430 [02:40<45:45,  8.07it/s]10/22/2025 09:37:31 - INFO - __main__ - Epoch 2/30, Step 500/781, Loss 0.027827350422739983 (0.031945836893886984)
  6%|███████                                                                                                                | 1382/23430 [02:53<45:28,  8.08it/s]10/22/2025 09:37:43 - INFO - __main__ - Epoch 2/30, Step 600/781, Loss 0.039016012102365494 (0.03145110690671821)
  6%|███████▌                                                                                                               | 1482/23430 [03:05<45:08,  8.10it/s]10/22/2025 09:37:56 - INFO - __main__ - Epoch 2/30, Step 700/781, Loss 0.031501736491918564 (0.031076579451688516)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 104.07it/s]
10/22/2025 09:38:07 - INFO - __main__ - Epoch 3/30████████████████████████████████████████████████████████████████████████     | 96/100 [00:00<00:00, 107.30it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-0-ddpm/checkpoints/checkpoint_epoch_1.pth
  7%|███████▊                                                                                                             | 1563/23430 [03:17<3:36:40,  1.68it/s]10/22/2025 09:38:07 - INFO - __main__ - Epoch 3/30, Step 0/781, Loss 0.03336499631404877 (0.03336499631404877)
  7%|████████▍                                                                                                              | 1663/23430 [03:29<44:45,  8.11it/s]10/22/2025 09:38:20 - INFO - __main__ - Epoch 3/30, Step 100/781, Loss 0.03826664015650749 (0.028743742955940784)
  8%|████████▉                                                                                                              | 1763/23430 [03:41<44:32,  8.11it/s]10/22/2025 09:38:32 - INFO - __main__ - Epoch 3/30, Step 200/781, Loss 0.03579537197947502 (0.029223981257806075)
  8%|█████████▍                                                                                                             | 1863/23430 [03:54<44:22,  8.10it/s]10/22/2025 09:38:44 - INFO - __main__ - Epoch 3/30, Step 300/781, Loss 0.029862841591238976 (0.028911853206043822)
  8%|█████████▉                                                                                                             | 1963/23430 [04:06<44:08,  8.11it/s]10/22/2025 09:38:57 - INFO - __main__ - Epoch 3/30, Step 400/781, Loss 0.027833405882120132 (0.028629717758468856)
  9%|██████████▍                                                                                                            | 2063/23430 [04:18<43:59,  8.09it/s]10/22/2025 09:39:09 - INFO - __main__ - Epoch 3/30, Step 500/781, Loss 0.039826489984989166 (0.028426012877531038)
  9%|██████████▉                                                                                                            | 2163/23430 [04:31<43:45,  8.10it/s]10/22/2025 09:39:21 - INFO - __main__ - Epoch 3/30, Step 600/781, Loss 0.03642628341913223 (0.028172316771936594)
 10%|███████████▍                                                                                                           | 2263/23430 [04:43<43:39,  8.08it/s]10/22/2025 09:39:34 - INFO - __main__ - Epoch 3/30, Step 700/781, Loss 0.01684846729040146 (0.02788949583905527)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 102.27it/s]
10/22/2025 09:39:45 - INFO - __main__ - Epoch 4/30██████████████████████████████████████████████████████████████████████████▌  | 98/100 [00:00<00:00, 103.52it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-0-ddpm/checkpoints/checkpoint_epoch_2.pth
 10%|███████████▋                                                                                                         | 2344/23430 [04:55<3:28:08,  1.69it/s]10/22/2025 09:39:45 - INFO - __main__ - Epoch 4/30, Step 0/781, Loss 0.029951147735118866 (0.029951147735118866)
 10%|████████████▍                                                                                                          | 2444/23430 [05:07<43:20,  8.07it/s]10/22/2025 09:39:58 - INFO - __main__ - Epoch 4/30, Step 100/781, Loss 0.033029403537511826 (0.02595071342432558)
 11%|████████████▉                                                                                                          | 2544/23430 [05:20<43:07,  8.07it/s]10/22/2025 09:40:10 - INFO - __main__ - Epoch 4/30, Step 200/781, Loss 0.021953344345092773 (0.025917664712378337)
 11%|█████████████▍                                                                                                         | 2644/23430 [05:32<42:54,  8.07it/s]10/22/2025 09:40:23 - INFO - __main__ - Epoch 4/30, Step 300/781, Loss 0.024883713573217392 (0.02618371922386643)
 12%|█████████████▉                                                                                                         | 2744/23430 [05:44<42:45,  8.06it/s]10/22/2025 09:40:35 - INFO - __main__ - Epoch 4/30, Step 400/781, Loss 0.024307090789079666 (0.02614292458275756)
 12%|██████████████▍                                                                                                        | 2844/23430 [05:57<42:29,  8.07it/s]10/22/2025 09:40:47 - INFO - __main__ - Epoch 4/30, Step 500/781, Loss 0.028490683063864708 (0.026332571966845)
 13%|██████████████▉                                                                                                        | 2944/23430 [06:09<42:20,  8.06it/s]10/22/2025 09:41:00 - INFO - __main__ - Epoch 4/30, Step 600/781, Loss 0.029480408877134323 (0.026410733961721822)
 13%|███████████████▍                                                                                                       | 3044/23430 [06:22<42:10,  8.06it/s]10/22/2025 09:41:12 - INFO - __main__ - Epoch 4/30, Step 700/781, Loss 0.022729333490133286 (0.02641085991914917)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 100.52it/s]
10/22/2025 09:41:23 - INFO - __main__ - Epoch 5/30████████████████████████████████████████████████████████████████████████     | 96/100 [00:00<00:00, 102.77it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-0-ddpm/checkpoints/checkpoint_epoch_3.pth
