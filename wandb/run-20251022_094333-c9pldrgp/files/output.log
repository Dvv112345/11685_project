10/22/2025 09:43:34 - INFO - __main__ - ***** Training arguments *****
10/22/2025 09:43:34 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', data_dir='/ocean/projects/cis250019p/jye9/11685-project/data', image_size=32, batch_size=64, num_workers=4, num_classes=10, run_name='exp-1-ddpm', output_dir='/ocean/projects/cis250019p/jye9/11685-project/experiments', num_epochs=30, learning_rate=0.0001, weight_decay=0, grad_clip=1.0, seed=42, mixed_precision='none', num_train_timesteps=2000, num_inference_steps=100, beta_start=0.0001, beta_end=0.02, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, optimizer_type='AdamW', scheduler_type='ConsineAnnealingLR', unet_in_size=32, unet_in_ch=3, unet_ch=128, unet_ch_mult=[1, 2, 2, 2], unet_attn=[1, 2, 3], unet_num_res_blocks=2, unet_dropout=0.2, latent_ddpm=False, pretrained_vae='/ocean/projects/cis250019p/jye9/11685-project/pretrained/model.ckpt', use_cfg=False, cfg_guidance_scale=2.0, use_ddim=False, ckpt=None, device='cuda', rank=0, world_size=1, predictor_type='epsilon', distributed=False, local_rank=0, total_batch_size=64, max_train_steps=23430)
10/22/2025 09:43:34 - INFO - __main__ - ***** Running training *****
10/22/2025 09:43:34 - INFO - __main__ -   Num examples = 50000
10/22/2025 09:43:34 - INFO - __main__ -   Num Epochs = 30
10/22/2025 09:43:34 - INFO - __main__ -   Instantaneous batch size per device = 64
10/22/2025 09:43:34 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 64
10/22/2025 09:43:34 - INFO - __main__ -   Total optimization steps per epoch 781
10/22/2025 09:43:34 - INFO - __main__ -   Total optimization steps = 23430
  0%|                                                                                                                                  | 0/23430 [00:00<?, ?it/s]10/22/2025 09:43:34 - INFO - __main__ - Epoch 1/30
  0%|                                                                                                                        | 1/23430 [00:00<5:07:44,  1.27it/s]10/22/2025 09:43:35 - INFO - __main__ - Epoch 1/30, Step 0/781, Loss 0.9998971223831177 (0.9998971223831177)
  0%|▌                                                                                                                     | 101/23430 [00:19<1:12:30,  5.36it/s]10/22/2025 09:43:54 - INFO - __main__ - Epoch 1/30, Step 100/781, Loss 0.7115147113800049 (0.8640480389689454)
  1%|█                                                                                                                     | 201/23430 [00:38<1:12:09,  5.37it/s]10/22/2025 09:44:12 - INFO - __main__ - Epoch 1/30, Step 200/781, Loss 0.3318327069282532 (0.6883194317568594)
  1%|█▌                                                                                                                    | 301/23430 [00:56<1:11:50,  5.37it/s]10/22/2025 09:44:31 - INFO - __main__ - Epoch 1/30, Step 300/781, Loss 0.13045820593833923 (0.5386320384237854)
  2%|██                                                                                                                    | 401/23430 [01:15<1:11:30,  5.37it/s]10/22/2025 09:44:50 - INFO - __main__ - Epoch 1/30, Step 400/781, Loss 0.04569031298160553 (0.4253759159615955)
  2%|██▌                                                                                                                   | 501/23430 [01:34<1:12:41,  5.26it/s]10/22/2025 09:45:08 - INFO - __main__ - Epoch 1/30, Step 500/781, Loss 0.046230919659137726 (0.34901487461835917)
  3%|███                                                                                                                   | 601/23430 [01:52<1:10:57,  5.36it/s]10/22/2025 09:45:27 - INFO - __main__ - Epoch 1/30, Step 600/781, Loss 0.05133999139070511 (0.2969228113906926)
  3%|███▌                                                                                                                  | 701/23430 [02:11<1:10:38,  5.36it/s]10/22/2025 09:45:46 - INFO - __main__ - Epoch 1/30, Step 700/781, Loss 0.02452923357486725 (0.2595216997337133)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 66.71it/s]
10/22/2025 09:46:02 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.1<00:00, 70.80it/s]
10/22/2025 09:46:02 - INFO - numexpr.utils - NumExpr defaulting to 16 threads.
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-1-ddpm/checkpoints/checkpoint_epoch_0.pth
10/22/2025 09:46:03 - INFO - __main__ - Epoch 2/30
  3%|███▉                                                                                                                  | 782/23430 [02:29<6:18:47,  1.00s/it]10/22/2025 09:46:03 - INFO - __main__ - Epoch 2/30, Step 0/781, Loss 0.024614274501800537 (0.024614274501800537)
  4%|████▍                                                                                                                 | 882/23430 [02:47<1:10:09,  5.36it/s]10/22/2025 09:46:22 - INFO - __main__ - Epoch 2/30, Step 100/781, Loss 0.019107991829514503 (0.032223873089371934)
  4%|████▉                                                                                                                 | 982/23430 [03:06<1:17:47,  4.81it/s]10/22/2025 09:46:41 - INFO - __main__ - Epoch 2/30, Step 200/781, Loss 0.028550799936056137 (0.03264422178620575)
  5%|█████▍                                                                                                               | 1082/23430 [03:25<1:09:46,  5.34it/s]10/22/2025 09:47:00 - INFO - __main__ - Epoch 2/30, Step 300/781, Loss 0.021729357540607452 (0.032082275227578574)
  5%|█████▉                                                                                                               | 1182/23430 [03:44<1:09:27,  5.34it/s]10/22/2025 09:47:18 - INFO - __main__ - Epoch 2/30, Step 400/781, Loss 0.022675734013319016 (0.03140337623079816)
  5%|██████▍                                                                                                              | 1282/23430 [04:02<1:09:08,  5.34it/s]10/22/2025 09:47:37 - INFO - __main__ - Epoch 2/30, Step 500/781, Loss 0.029676362872123718 (0.03101523813351007)
  6%|██████▉                                                                                                              | 1382/23430 [04:21<1:08:54,  5.33it/s]10/22/2025 09:47:56 - INFO - __main__ - Epoch 2/30, Step 600/781, Loss 0.023662840947508812 (0.03050666833342907)
  6%|███████▍                                                                                                             | 1482/23430 [04:40<1:08:43,  5.32it/s]10/22/2025 09:48:15 - INFO - __main__ - Epoch 2/30, Step 700/781, Loss 0.026787124574184418 (0.030268038451650343)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 67.25it/s]
10/22/2025 09:48:32 - INFO - __main__ - Epoch 3/30███████████████████████████████████████████████████████████████████████████▌  | 98/100 [00:01<00:00, 67.84it/s]
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-1-ddpm/checkpoints/checkpoint_epoch_1.pth
  7%|███████▊                                                                                                             | 1563/23430 [04:57<5:17:12,  1.15it/s]10/22/2025 09:48:32 - INFO - __main__ - Epoch 3/30, Step 0/781, Loss 0.02235720120370388 (0.02235720120370388)
  7%|████████▎                                                                                                            | 1663/23430 [05:16<1:08:09,  5.32it/s]10/22/2025 09:48:51 - INFO - __main__ - Epoch 3/30, Step 100/781, Loss 0.01696031354367733 (0.028776254956748817)
  8%|████████▊                                                                                                            | 1763/23430 [05:35<1:08:00,  5.31it/s]10/22/2025 09:49:10 - INFO - __main__ - Epoch 3/30, Step 200/781, Loss 0.04600101709365845 (0.02810571000758392)
  8%|████████▊                                                                                                            | 1768/23430 [05:36<1:07:51,  5.32it/s]
