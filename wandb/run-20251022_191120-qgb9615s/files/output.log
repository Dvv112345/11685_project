10/22/2025 19:11:28 - INFO - __main__ - ***** Training arguments *****
10/22/2025 19:11:28 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', data_dir='/ocean/projects/cis250019p/jye9/11685-project/data', is_cifar_10=True, image_size=32, batch_size=32, num_workers=4, num_classes=10, run_name='exp-1-ddpm', output_dir='/ocean/projects/cis250019p/jye9/11685-project/experiments', num_epochs=300, learning_rate=0.0005, weight_decay=0, grad_clip=1.0, seed=42, mixed_precision='none', use_val=True, num_train_timesteps=500, num_inference_steps=500, beta_start=0.0001, beta_end=0.1, beta_schedule='cosine', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, optimizer_type='AdamW', scheduler_type='ConsineAnnealingLR', unet_in_size=32, unet_in_ch=3, unet_ch=64, unet_ch_mult=[1, 2, 2, 4], unet_attn=[2, 3], unet_num_res_blocks=1, unet_dropout=0.2, latent_ddpm=False, pretrained_vae='/ocean/projects/cis250019p/jye9/11685-project/pretrained/model.ckpt', use_cfg=False, cfg_guidance_scale=2.0, use_ddim=False, ckpt=None, device='cuda', rank=0, world_size=1, predictor_type='epsilon', distributed=False, local_rank=0, total_batch_size=32, max_train_steps=468600)
10/22/2025 19:11:28 - INFO - __main__ - ***** Running training *****
10/22/2025 19:11:28 - INFO - __main__ -   Num examples = 50000
10/22/2025 19:11:28 - INFO - __main__ -   Num Epochs = 300
10/22/2025 19:11:28 - INFO - __main__ -   Instantaneous batch size per device = 32
10/22/2025 19:11:28 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 32
10/22/2025 19:11:28 - INFO - __main__ -   Total optimization steps per epoch 1562
10/22/2025 19:11:28 - INFO - __main__ -   Total optimization steps = 468600
  0%|                                                                                                                                 | 0/468600 [00:00<?, ?it/s]10/22/2025 19:11:28 - INFO - __main__ - Epoch 1/300
  0%|▍                                                                                                                   | 1560/468600 [00:54<4:15:54, 30.42it/s]10/22/2025 19:12:23 - INFO - __main__ - Epoch 1/300, Step 1561/1562, Loss 0.0740380734205246 (0.10540483149767838)
10/22/2025 19:12:24 - INFO - __main__ - Epoch 1/300 Validation Loss: 0.070229
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:03<00:00, 127.70it/s]
10/22/2025 19:12:35 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.<00:00, 130.67it/s]
10/22/2025 19:12:35 - INFO - numexpr.utils - NumExpr defaulting to 16 threads.
  0%|▍                                                                                                                   | 1562/468600 [01:10<4:15:54, 30.42it/s]10/22/2025 19:12:41 - INFO - __main__ - Epoch 2/300
Checkpoint saved at /ocean/projects/cis250019p/jye9/11685-project/experiments/exp-1-ddpm/checkpoints/checkpoint_epoch_0.pth
  1%|▊                                                                                                                   | 3124/468600 [02:03<4:13:38, 30.59it/s]10/22/2025 19:13:32 - INFO - __main__ - Epoch 2/300, Step 1561/1562, Loss 0.09488570690155029 (0.06872536806048642)
10/22/2025 19:13:33 - INFO - __main__ - Epoch 2/300 Validation Loss: 0.063260
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:04<00:00, 124.36it/s]
10/22/2025 19:13:37 - INFO - __main__ - Epoch 3/300█████████████████████████████████████████████████████████████████████████▎ | 492/499 [00:03<00:00, 125.14it/s]
  1%|█▏                                                                                                                  | 4684/468600 [03:00<4:16:14, 30.17it/s]10/22/2025 19:14:29 - INFO - __main__ - Epoch 3/300, Step 1561/1562, Loss 0.08806774020195007 (0.06497489710108266)
10/22/2025 19:14:30 - INFO - __main__ - Epoch 3/300 Validation Loss: 0.064738
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:03<00:00, 128.19it/s]
10/22/2025 19:14:34 - INFO - __main__ - Epoch 4/300█████████████████████████████████████████████████████████████████████████▊ | 494/499 [00:03<00:00, 128.45it/s]
  1%|█▌                                                                                                                  | 6247/468600 [03:57<4:12:16, 30.55it/s]10/22/2025 19:15:26 - INFO - __main__ - Epoch 4/300, Step 1561/1562, Loss 0.06685735285282135 (0.06414177761235479)
10/22/2025 19:15:27 - INFO - __main__ - Epoch 4/300 Validation Loss: 0.060545
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:03<00:00, 125.10it/s]
10/22/2025 19:15:31 - INFO - __main__ - Epoch 5/300█████████████████████████████████████████████████████████████████████████▊ | 494/499 [00:03<00:00, 125.60it/s]
  2%|█▉                                                                                                                  | 7810/468600 [04:54<4:12:09, 30.46it/s]10/22/2025 19:16:22 - INFO - __main__ - Epoch 5/300, Step 1561/1562, Loss 0.043353479355573654 (0.06248150864036494)
10/22/2025 19:16:24 - INFO - __main__ - Epoch 5/300 Validation Loss: 0.061825
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:03<00:00, 125.28it/s]
10/22/2025 19:16:28 - INFO - __main__ - Epoch 6/300█████████████████████████████████████████████████████████████████████████▊ | 494/499 [00:03<00:00, 125.43it/s]
  2%|██▎                                                                                                                 | 9370/468600 [05:50<4:11:42, 30.41it/s]10/22/2025 19:17:19 - INFO - __main__ - Epoch 6/300, Step 1561/1562, Loss 0.04741285741329193 (0.062055523681398314)
10/22/2025 19:17:20 - INFO - __main__ - Epoch 6/300 Validation Loss: 0.058315
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:03<00:00, 126.85it/s]
10/22/2025 19:17:24 - INFO - __main__ - Epoch 7/300█████████████████████████████████████████████████████████████████████████▊ | 494/499 [00:03<00:00, 126.93it/s]
  2%|██▋                                                                                                                | 10934/468600 [06:47<4:11:19, 30.35it/s]10/22/2025 19:18:15 - INFO - __main__ - Epoch 7/300, Step 1561/1562, Loss 0.05574032664299011 (0.061191085330121193)
10/22/2025 19:18:17 - INFO - __main__ - Epoch 7/300 Validation Loss: 0.062217
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:03<00:00, 127.34it/s]
10/22/2025 19:18:21 - INFO - __main__ - Epoch 8/300█████████████████████████████████████████████████████████████████████████▊ | 494/499 [00:03<00:00, 127.51it/s]
  3%|███                                                                                                                | 12493/468600 [07:43<4:08:53, 30.54it/s]10/22/2025 19:19:12 - INFO - __main__ - Epoch 8/300, Step 1561/1562, Loss 0.03690836578607559 (0.06090356797819406)
10/22/2025 19:19:13 - INFO - __main__ - Epoch 8/300 Validation Loss: 0.058227
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:03<00:00, 127.75it/s]
10/22/2025 19:19:17 - INFO - __main__ - Epoch 9/300█████████████████████████████████████████████████████████████████████████▊ | 494/499 [00:03<00:00, 127.29it/s]
  3%|███▍                                                                                                               | 14056/468600 [08:40<4:09:31, 30.36it/s]10/22/2025 19:20:09 - INFO - __main__ - Epoch 9/300, Step 1561/1562, Loss 0.07077034562826157 (0.06065443264399196)
10/22/2025 19:20:10 - INFO - __main__ - Epoch 9/300 Validation Loss: 0.056994
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:03<00:00, 126.31it/s]
10/22/2025 19:20:14 - INFO - __main__ - Epoch 10/300████████████████████████████████████████████████████████████████████████▊ | 494/499 [00:03<00:00, 126.44it/s]
  3%|███▊                                                                                                               | 15620/468600 [09:36<4:10:39, 30.12it/s]10/22/2025 19:21:05 - INFO - __main__ - Epoch 10/300, Step 1561/1562, Loss 0.06941995024681091 (0.059886997446379646)
10/22/2025 19:21:06 - INFO - __main__ - Epoch 10/300 Validation Loss: 0.058812
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:03<00:00, 124.81it/s]
10/22/2025 19:21:10 - INFO - __main__ - Epoch 11/300████████████████████████████████████████████████████████████████████████▊ | 494/499 [00:03<00:00, 124.40it/s]
  4%|████▏                                                                                                              | 17180/468600 [10:33<4:06:46, 30.49it/s]10/22/2025 19:22:02 - INFO - __main__ - Epoch 11/300, Step 1561/1562, Loss 0.07580534368753433 (0.060009558920041395)
10/22/2025 19:22:03 - INFO - __main__ - Epoch 11/300 Validation Loss: 0.056762
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:03<00:00, 125.76it/s]
10/22/2025 19:22:07 - INFO - __main__ - Epoch 12/300████████████████████████████████████████████████████████████████████████▊ | 494/499 [00:03<00:00, 125.88it/s]
  4%|████▍                                                                                                              | 17875/468600 [11:01<4:06:40, 30.45it/s]
